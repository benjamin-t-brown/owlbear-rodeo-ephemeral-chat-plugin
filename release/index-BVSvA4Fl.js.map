{"version":3,"file":"index-BVSvA4Fl.js","sources":["../../node_modules/@owlbear-rodeo/sdk/lib/api/PlayerApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/ViewportApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/messages/Message.js","../../node_modules/events/events.js","../../node_modules/uuid/dist/esm-browser/rng.js","../../node_modules/uuid/dist/esm-browser/stringify.js","../../node_modules/uuid/dist/esm-browser/native.js","../../node_modules/uuid/dist/esm-browser/v4.js","../../node_modules/@owlbear-rodeo/sdk/lib/messages/MessageBus.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/NotificationApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/scene/SceneFogApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/scene/SceneGridApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/scene/SceneHistoryApi.js","../../node_modules/immer/dist/immer.mjs","../../node_modules/@owlbear-rodeo/sdk/lib/api/scene/SceneItemsApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/scene/SceneLocalApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/scene/SceneApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/common/normalize.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/ContextMenuApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/ToolApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/PopoverApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/ModalApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/ActionApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/InteractionApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/PartyApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/RoomApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/ThemeApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/AssetsApi.js","../../node_modules/@owlbear-rodeo/sdk/lib/api/BroadcastApi.js","../../node_modules/js-base64/base64.mjs","../../node_modules/@owlbear-rodeo/sdk/lib/common/getDetails.js","../../node_modules/@owlbear-rodeo/sdk/lib/types/items/Path.js","../../node_modules/@owlbear-rodeo/sdk/lib/index.js","../../src/actions.ts","../../src/state.ts","../../src/ui/ClElement.ts","../../src/ui/colors.ts","../../src/ui/elements/BasicButton.ts","../../src/ui/elements/ChatMessages.ts","../../src/ui/elements/Textarea.ts","../../src/ui/components/Chat.ts","../../src/main.ts"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass PlayerApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    get id() {\n        // Get the user id from the message bus which will be populated once OBR_READY is handled\n        if (!this.messageBus.userId) {\n            throw Error(\"Unable to get user ID: not ready\");\n        }\n        return this.messageBus.userId;\n    }\n    getSelection() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { selection } = yield this.messageBus.sendAsync(\"OBR_PLAYER_GET_SELECTION\", {});\n            return selection;\n        });\n    }\n    select(items, replace) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_PLAYER_SELECT\", { items, replace });\n        });\n    }\n    deselect(items) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_PLAYER_DESELECT\", { items });\n        });\n    }\n    getName() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { name } = yield this.messageBus.sendAsync(\"OBR_PLAYER_GET_NAME\", {});\n            return name;\n        });\n    }\n    setName(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_PLAYER_SET_NAME\", { name });\n        });\n    }\n    getColor() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { color } = yield this.messageBus.sendAsync(\"OBR_PLAYER_GET_COLOR\", {});\n            return color;\n        });\n    }\n    setColor(color) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_PLAYER_SET_COLOR\", { color });\n        });\n    }\n    getSyncView() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { syncView } = yield this.messageBus.sendAsync(\"OBR_PLAYER_GET_SYNC_VIEW\", {});\n            return syncView;\n        });\n    }\n    setSyncView(syncView) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_PLAYER_SET_SYNC_VIEW\", { syncView });\n        });\n    }\n    getId() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { id } = yield this.messageBus.sendAsync(\"OBR_PLAYER_GET_ID\", {});\n            return id;\n        });\n    }\n    getRole() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { role } = yield this.messageBus.sendAsync(\"OBR_PLAYER_GET_ROLE\", {});\n            return role;\n        });\n    }\n    getMetadata() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { metadata } = yield this.messageBus.sendAsync(\"OBR_PLAYER_GET_METADATA\", {});\n            return metadata;\n        });\n    }\n    setMetadata(update) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_PLAYER_SET_METADATA\", { update });\n        });\n    }\n    hasPermission(permission) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const role = yield this.getRole();\n            if (role === \"GM\") {\n                return true;\n            }\n            const { permissions } = yield this.messageBus.sendAsync(\"OBR_ROOM_GET_PERMISSIONS\", {});\n            return permissions.indexOf(permission) > -1;\n        });\n    }\n    getConnectionId() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { connectionId } = yield this.messageBus.sendAsync(\"OBR_PLAYER_GET_CONNECTION_ID\", {});\n            return connectionId;\n        });\n    }\n    onChange(callback) {\n        const handleChange = (data) => {\n            callback(data.player);\n        };\n        this.messageBus.send(\"OBR_PLAYER_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_PLAYER_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_PLAYER_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_PLAYER_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default PlayerApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass ViewportApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    reset() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { transform } = yield this.messageBus.sendAsync(\"OBR_VIEWPORT_RESET\", {});\n            return transform;\n        });\n    }\n    animateTo(transform) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_VIEWPORT_ANIMATE_TO\", { transform });\n        });\n    }\n    animateToBounds(bounds) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_VIEWPORT_ANIMATE_TO_BOUNDS\", {\n                bounds,\n            });\n        });\n    }\n    getPosition() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { position } = yield this.messageBus.sendAsync(\"OBR_VIEWPORT_GET_POSITION\", {});\n            return position;\n        });\n    }\n    setPosition(position) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_VIEWPORT_SET_POSITION\", { position });\n        });\n    }\n    getScale() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { scale } = yield this.messageBus.sendAsync(\"OBR_VIEWPORT_GET_SCALE\", {});\n            return scale;\n        });\n    }\n    setScale(scale) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_VIEWPORT_SET_SCALE\", { scale });\n        });\n    }\n    getWidth() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { width } = yield this.messageBus.sendAsync(\"OBR_VIEWPORT_GET_WIDTH\", {});\n            return width;\n        });\n    }\n    getHeight() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { height } = yield this.messageBus.sendAsync(\"OBR_VIEWPORT_GET_HEIGHT\", {});\n            return height;\n        });\n    }\n    transformPoint(point) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { point: transformed } = yield this.messageBus.sendAsync(\"OBR_VIEWPORT_TRANSFORM_POINT\", { point });\n            return transformed;\n        });\n    }\n    inverseTransformPoint(point) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { point: transformed } = yield this.messageBus.sendAsync(\"OBR_VIEWPORT_INVERSE_TRANSFORM_POINT\", { point });\n            return transformed;\n        });\n    }\n}\nexport default ViewportApi;\n","export function isMessage(message) {\n    return typeof message.id === \"string\";\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import { isMessage } from \"./Message\";\nimport { EventEmitter } from \"events\";\nimport { v4 as uuid } from \"uuid\";\nclass MessageBus extends EventEmitter {\n    constructor(origin, roomId) {\n        super();\n        this.ready = false;\n        /** The user ID of the player using this extension */\n        this.userId = null;\n        /** A reference ID used to get responses from the target  */\n        this.ref = null;\n        this.handleMessage = (event) => {\n            const message = event.data;\n            // Ensure the message is meant for us and check that it is formatted correctly\n            if (event.origin === this.targetOrigin && isMessage(message)) {\n                // Handle the ready event\n                if (message.id === \"OBR_READY\") {\n                    this.ready = true;\n                    const data = message.data;\n                    this.ref = data.ref;\n                    this.userId = data.userId;\n                }\n                this.emit(message.id, message.data);\n            }\n        };\n        /**\n         * @param nonce\n         * A nonce that will be appended to the response event ID\n         * This allows concurrent calls to the same API endpoint\n         * For example a call to `GET_ITEM` will respond with the `GET_ITEM_RESPONSE`\n         * event. But if we make two concurrent calls to `GET_ITEM`\n         * we cannot differentiate between the two `GET_ITEM_RESPONSE`\n         * events. This nonce will be appended to the response so that\n         * a `GET_ITEM` event called with the nonce `_123` will respond\n         * with `GET_ITEM_RESPONSE_123`.\n         */\n        this.send = (id, data, nonce) => {\n            var _a;\n            if (!this.ref) {\n                throw Error(\"Unable to send message: not ready\");\n            }\n            (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\n                id,\n                data,\n                ref: this.ref,\n                nonce,\n            }, this.targetOrigin);\n        };\n        this.sendAsync = (id, data, timeout = 5000) => {\n            const nonce = `_${uuid()}`;\n            this.send(id, data, nonce);\n            return Promise.race([\n                new Promise((resolve, reject) => {\n                    const self = this;\n                    function onResponse(value) {\n                        // Remove listeners for this event to avoid memory and data leaks\n                        self.off(`${id}_RESPONSE${nonce}`, onResponse);\n                        self.off(`${id}_ERROR${nonce}`, onError);\n                        resolve(value);\n                    }\n                    function onError(error) {\n                        self.off(`${id}_RESPONSE${nonce}`, onResponse);\n                        self.off(`${id}_ERROR${nonce}`, onError);\n                        reject(error);\n                    }\n                    this.on(`${id}_RESPONSE${nonce}`, onResponse);\n                    this.on(`${id}_ERROR${nonce}`, onError);\n                }),\n                ...(timeout > 0\n                    ? [\n                        new Promise((_, reject) => window.setTimeout(() => reject(new Error(`Message ${id} took longer than ${timeout}ms to get a result`)), timeout)),\n                    ]\n                    : []),\n            ]);\n        };\n        this.roomId = roomId;\n        this.targetOrigin = origin;\n        window.addEventListener(\"message\", this.handleMessage);\n        // Increase max listeners to prevent warning message from update events\n        this.setMaxListeners(100);\n    }\n    destroy() {\n        window.removeEventListener(\"message\", this.handleMessage);\n    }\n}\nexport default MessageBus;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass NotificationApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    show(message, variant) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { id } = yield this.messageBus.sendAsync(\"OBR_NOTIFICATION_SHOW\", { message, variant });\n            return id;\n        });\n    }\n    close(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_NOTIFICATION_CLOSE\", { id });\n        });\n    }\n}\nexport default NotificationApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass SceneFogApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    getColor() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { color } = yield this.messageBus.sendAsync(\"OBR_SCENE_FOG_GET_COLOR\", {});\n            return color;\n        });\n    }\n    setColor(color) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_FOG_SET_COLOR\", { color });\n        });\n    }\n    getStrokeWidth() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { strokeWidth } = yield this.messageBus.sendAsync(\"OBR_SCENE_FOG_GET_STROKE_WIDTH\", {});\n            return strokeWidth;\n        });\n    }\n    setStrokeWidth(strokeWidth) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_FOG_SET_STROKE_WIDTH\", {\n                strokeWidth,\n            });\n        });\n    }\n    getFilled() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { filled } = yield this.messageBus.sendAsync(\"OBR_SCENE_FOG_GET_FILLED\", {});\n            return filled;\n        });\n    }\n    setFilled(filled) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_FOG_SET_FILLED\", { filled });\n        });\n    }\n    onChange(callback) {\n        const handleChange = (data) => {\n            callback(data.fog);\n        };\n        this.messageBus.send(\"OBR_SCENE_FOG_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_SCENE_FOG_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_SCENE_FOG_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_SCENE_FOG_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default SceneFogApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass SceneGridApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    getDpi() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { dpi } = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_GET_DPI\", {});\n            return dpi;\n        });\n    }\n    getScale() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const scale = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_GET_SCALE\", {});\n            return scale;\n        });\n    }\n    setScale(scale) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_SET_SCALE\", { scale });\n        });\n    }\n    getColor() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { color } = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_GET_COLOR\", {});\n            return color;\n        });\n    }\n    setColor(color) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_SET_COLOR\", { color });\n        });\n    }\n    getOpacity() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { opacity } = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_GET_OPACITY\", {});\n            return opacity;\n        });\n    }\n    setOpacity(opacity) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_SET_OPACITY\", { opacity });\n        });\n    }\n    getType() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { type } = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_GET_TYPE\", {});\n            return type;\n        });\n    }\n    setType(type) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_SET_TYPE\", { type });\n        });\n    }\n    getLineType() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { lineType } = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_GET_LINE_TYPE\", {});\n            return lineType;\n        });\n    }\n    setLineType(lineType) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_SET_LINE_TYPE\", {\n                lineType,\n            });\n        });\n    }\n    getMeasurement() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { measurement } = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_GET_MEASUREMENT\", {});\n            return measurement;\n        });\n    }\n    setMeasurement(measurement) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_SET_MEASUREMENT\", {\n                measurement,\n            });\n        });\n    }\n    getLineWidth() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { lineWidth } = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_GET_LINE_WIDTH\", {});\n            return lineWidth;\n        });\n    }\n    setLineWidth(lineWidth) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_SET_LINE_WIDTH\", {\n                lineWidth,\n            });\n        });\n    }\n    snapPosition(position, snappingSensitivity, useCorners, useCenter) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { position: snapped } = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_SNAP_POSITION\", {\n                position,\n                snappingSensitivity,\n                useCorners,\n                useCenter,\n            });\n            return snapped;\n        });\n    }\n    getDistance(from, to) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { distance } = yield this.messageBus.sendAsync(\"OBR_SCENE_GRID_GET_DISTANCE\", { from, to });\n            return distance;\n        });\n    }\n    onChange(callback) {\n        const handleChange = (data) => {\n            callback(data.grid);\n        };\n        this.messageBus.send(\"OBR_SCENE_GRID_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_SCENE_GRID_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_SCENE_GRID_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_SCENE_GRID_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default SceneGridApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass SceneHistoryApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    undo() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_HISTORY_UNDO\", {});\n        });\n    }\n    redo() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_HISTORY_REDO\", {});\n        });\n    }\n    canUndo() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { canUndo } = yield this.messageBus.sendAsync(\"OBR_SCENE_HISTORY_CAN_UNDO\", {});\n            return canUndo;\n        });\n    }\n    canRedo() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { canRedo } = yield this.messageBus.sendAsync(\"OBR_SCENE_HISTORY_CAN_REDO\", {});\n            return canRedo;\n        });\n    }\n}\nexport default SceneHistoryApi;\n","// src/utils/env.ts\nvar NOTHING = Symbol.for(\"immer-nothing\");\nvar DRAFTABLE = Symbol.for(\"immer-draftable\");\nvar DRAFT_STATE = Symbol.for(\"immer-state\");\n\n// src/utils/errors.ts\nvar errors = process.env.NODE_ENV !== \"production\" ? [\n  // All error codes, starting by 0:\n  function(plugin) {\n    return `The plugin for '${plugin}' has not been loaded into Immer. To enable the plugin, import and call \\`enable${plugin}()\\` when initializing your application.`;\n  },\n  function(thing) {\n    return `produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${thing}'`;\n  },\n  \"This object has been frozen and should not be mutated\",\n  function(data) {\n    return \"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \" + data;\n  },\n  \"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",\n  \"Immer forbids circular references\",\n  \"The first or second argument to `produce` must be a function\",\n  \"The third argument to `produce` must be a function or undefined\",\n  \"First argument to `createDraft` must be a plain object, an array, or an immerable object\",\n  \"First argument to `finishDraft` must be a draft returned by `createDraft`\",\n  function(thing) {\n    return `'current' expects a draft, got: ${thing}`;\n  },\n  \"Object.defineProperty() cannot be used on an Immer draft\",\n  \"Object.setPrototypeOf() cannot be used on an Immer draft\",\n  \"Immer only supports deleting array indices\",\n  \"Immer only supports setting array indices and the 'length' property\",\n  function(thing) {\n    return `'original' expects a draft, got: ${thing}`;\n  }\n  // Note: if more errors are added, the errorOffset in Patches.ts should be increased\n  // See Patches.ts for additional errors\n] : [];\nfunction die(error, ...args) {\n  if (process.env.NODE_ENV !== \"production\") {\n    const e = errors[error];\n    const msg = typeof e === \"function\" ? e.apply(null, args) : e;\n    throw new Error(`[Immer] ${msg}`);\n  }\n  throw new Error(\n    `[Immer] minified error nr: ${error}. Full error at: https://bit.ly/3cXEKWf`\n  );\n}\n\n// src/utils/common.ts\nvar getPrototypeOf = Object.getPrototypeOf;\nfunction isDraft(value) {\n  return !!value && !!value[DRAFT_STATE];\n}\nfunction isDraftable(value) {\n  if (!value)\n    return false;\n  return isPlainObject(value) || Array.isArray(value) || !!value[DRAFTABLE] || !!value.constructor?.[DRAFTABLE] || isMap(value) || isSet(value);\n}\nvar objectCtorString = Object.prototype.constructor.toString();\nfunction isPlainObject(value) {\n  if (!value || typeof value !== \"object\")\n    return false;\n  const proto = getPrototypeOf(value);\n  if (proto === null) {\n    return true;\n  }\n  const Ctor = Object.hasOwnProperty.call(proto, \"constructor\") && proto.constructor;\n  if (Ctor === Object)\n    return true;\n  return typeof Ctor == \"function\" && Function.toString.call(Ctor) === objectCtorString;\n}\nfunction original(value) {\n  if (!isDraft(value))\n    die(15, value);\n  return value[DRAFT_STATE].base_;\n}\nfunction each(obj, iter) {\n  if (getArchtype(obj) === 0 /* Object */) {\n    Reflect.ownKeys(obj).forEach((key) => {\n      iter(key, obj[key], obj);\n    });\n  } else {\n    obj.forEach((entry, index) => iter(index, entry, obj));\n  }\n}\nfunction getArchtype(thing) {\n  const state = thing[DRAFT_STATE];\n  return state ? state.type_ : Array.isArray(thing) ? 1 /* Array */ : isMap(thing) ? 2 /* Map */ : isSet(thing) ? 3 /* Set */ : 0 /* Object */;\n}\nfunction has(thing, prop) {\n  return getArchtype(thing) === 2 /* Map */ ? thing.has(prop) : Object.prototype.hasOwnProperty.call(thing, prop);\n}\nfunction get(thing, prop) {\n  return getArchtype(thing) === 2 /* Map */ ? thing.get(prop) : thing[prop];\n}\nfunction set(thing, propOrOldValue, value) {\n  const t = getArchtype(thing);\n  if (t === 2 /* Map */)\n    thing.set(propOrOldValue, value);\n  else if (t === 3 /* Set */) {\n    thing.add(value);\n  } else\n    thing[propOrOldValue] = value;\n}\nfunction is(x, y) {\n  if (x === y) {\n    return x !== 0 || 1 / x === 1 / y;\n  } else {\n    return x !== x && y !== y;\n  }\n}\nfunction isMap(target) {\n  return target instanceof Map;\n}\nfunction isSet(target) {\n  return target instanceof Set;\n}\nfunction latest(state) {\n  return state.copy_ || state.base_;\n}\nfunction shallowCopy(base, strict) {\n  if (isMap(base)) {\n    return new Map(base);\n  }\n  if (isSet(base)) {\n    return new Set(base);\n  }\n  if (Array.isArray(base))\n    return Array.prototype.slice.call(base);\n  const isPlain = isPlainObject(base);\n  if (strict === true || strict === \"class_only\" && !isPlain) {\n    const descriptors = Object.getOwnPropertyDescriptors(base);\n    delete descriptors[DRAFT_STATE];\n    let keys = Reflect.ownKeys(descriptors);\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      const desc = descriptors[key];\n      if (desc.writable === false) {\n        desc.writable = true;\n        desc.configurable = true;\n      }\n      if (desc.get || desc.set)\n        descriptors[key] = {\n          configurable: true,\n          writable: true,\n          // could live with !!desc.set as well here...\n          enumerable: desc.enumerable,\n          value: base[key]\n        };\n    }\n    return Object.create(getPrototypeOf(base), descriptors);\n  } else {\n    const proto = getPrototypeOf(base);\n    if (proto !== null && isPlain) {\n      return { ...base };\n    }\n    const obj = Object.create(proto);\n    return Object.assign(obj, base);\n  }\n}\nfunction freeze(obj, deep = false) {\n  if (isFrozen(obj) || isDraft(obj) || !isDraftable(obj))\n    return obj;\n  if (getArchtype(obj) > 1) {\n    obj.set = obj.add = obj.clear = obj.delete = dontMutateFrozenCollections;\n  }\n  Object.freeze(obj);\n  if (deep)\n    Object.entries(obj).forEach(([key, value]) => freeze(value, true));\n  return obj;\n}\nfunction dontMutateFrozenCollections() {\n  die(2);\n}\nfunction isFrozen(obj) {\n  return Object.isFrozen(obj);\n}\n\n// src/utils/plugins.ts\nvar plugins = {};\nfunction getPlugin(pluginKey) {\n  const plugin = plugins[pluginKey];\n  if (!plugin) {\n    die(0, pluginKey);\n  }\n  return plugin;\n}\nfunction loadPlugin(pluginKey, implementation) {\n  if (!plugins[pluginKey])\n    plugins[pluginKey] = implementation;\n}\n\n// src/core/scope.ts\nvar currentScope;\nfunction getCurrentScope() {\n  return currentScope;\n}\nfunction createScope(parent_, immer_) {\n  return {\n    drafts_: [],\n    parent_,\n    immer_,\n    // Whenever the modified draft contains a draft from another scope, we\n    // need to prevent auto-freezing so the unowned draft can be finalized.\n    canAutoFreeze_: true,\n    unfinalizedDrafts_: 0\n  };\n}\nfunction usePatchesInScope(scope, patchListener) {\n  if (patchListener) {\n    getPlugin(\"Patches\");\n    scope.patches_ = [];\n    scope.inversePatches_ = [];\n    scope.patchListener_ = patchListener;\n  }\n}\nfunction revokeScope(scope) {\n  leaveScope(scope);\n  scope.drafts_.forEach(revokeDraft);\n  scope.drafts_ = null;\n}\nfunction leaveScope(scope) {\n  if (scope === currentScope) {\n    currentScope = scope.parent_;\n  }\n}\nfunction enterScope(immer2) {\n  return currentScope = createScope(currentScope, immer2);\n}\nfunction revokeDraft(draft) {\n  const state = draft[DRAFT_STATE];\n  if (state.type_ === 0 /* Object */ || state.type_ === 1 /* Array */)\n    state.revoke_();\n  else\n    state.revoked_ = true;\n}\n\n// src/core/finalize.ts\nfunction processResult(result, scope) {\n  scope.unfinalizedDrafts_ = scope.drafts_.length;\n  const baseDraft = scope.drafts_[0];\n  const isReplaced = result !== void 0 && result !== baseDraft;\n  if (isReplaced) {\n    if (baseDraft[DRAFT_STATE].modified_) {\n      revokeScope(scope);\n      die(4);\n    }\n    if (isDraftable(result)) {\n      result = finalize(scope, result);\n      if (!scope.parent_)\n        maybeFreeze(scope, result);\n    }\n    if (scope.patches_) {\n      getPlugin(\"Patches\").generateReplacementPatches_(\n        baseDraft[DRAFT_STATE].base_,\n        result,\n        scope.patches_,\n        scope.inversePatches_\n      );\n    }\n  } else {\n    result = finalize(scope, baseDraft, []);\n  }\n  revokeScope(scope);\n  if (scope.patches_) {\n    scope.patchListener_(scope.patches_, scope.inversePatches_);\n  }\n  return result !== NOTHING ? result : void 0;\n}\nfunction finalize(rootScope, value, path) {\n  if (isFrozen(value))\n    return value;\n  const state = value[DRAFT_STATE];\n  if (!state) {\n    each(\n      value,\n      (key, childValue) => finalizeProperty(rootScope, state, value, key, childValue, path)\n    );\n    return value;\n  }\n  if (state.scope_ !== rootScope)\n    return value;\n  if (!state.modified_) {\n    maybeFreeze(rootScope, state.base_, true);\n    return state.base_;\n  }\n  if (!state.finalized_) {\n    state.finalized_ = true;\n    state.scope_.unfinalizedDrafts_--;\n    const result = state.copy_;\n    let resultEach = result;\n    let isSet2 = false;\n    if (state.type_ === 3 /* Set */) {\n      resultEach = new Set(result);\n      result.clear();\n      isSet2 = true;\n    }\n    each(\n      resultEach,\n      (key, childValue) => finalizeProperty(rootScope, state, result, key, childValue, path, isSet2)\n    );\n    maybeFreeze(rootScope, result, false);\n    if (path && rootScope.patches_) {\n      getPlugin(\"Patches\").generatePatches_(\n        state,\n        path,\n        rootScope.patches_,\n        rootScope.inversePatches_\n      );\n    }\n  }\n  return state.copy_;\n}\nfunction finalizeProperty(rootScope, parentState, targetObject, prop, childValue, rootPath, targetIsSet) {\n  if (process.env.NODE_ENV !== \"production\" && childValue === targetObject)\n    die(5);\n  if (isDraft(childValue)) {\n    const path = rootPath && parentState && parentState.type_ !== 3 /* Set */ && // Set objects are atomic since they have no keys.\n    !has(parentState.assigned_, prop) ? rootPath.concat(prop) : void 0;\n    const res = finalize(rootScope, childValue, path);\n    set(targetObject, prop, res);\n    if (isDraft(res)) {\n      rootScope.canAutoFreeze_ = false;\n    } else\n      return;\n  } else if (targetIsSet) {\n    targetObject.add(childValue);\n  }\n  if (isDraftable(childValue) && !isFrozen(childValue)) {\n    if (!rootScope.immer_.autoFreeze_ && rootScope.unfinalizedDrafts_ < 1) {\n      return;\n    }\n    finalize(rootScope, childValue);\n    if ((!parentState || !parentState.scope_.parent_) && typeof prop !== \"symbol\" && Object.prototype.propertyIsEnumerable.call(targetObject, prop))\n      maybeFreeze(rootScope, childValue);\n  }\n}\nfunction maybeFreeze(scope, value, deep = false) {\n  if (!scope.parent_ && scope.immer_.autoFreeze_ && scope.canAutoFreeze_) {\n    freeze(value, deep);\n  }\n}\n\n// src/core/proxy.ts\nfunction createProxyProxy(base, parent) {\n  const isArray = Array.isArray(base);\n  const state = {\n    type_: isArray ? 1 /* Array */ : 0 /* Object */,\n    // Track which produce call this is associated with.\n    scope_: parent ? parent.scope_ : getCurrentScope(),\n    // True for both shallow and deep changes.\n    modified_: false,\n    // Used during finalization.\n    finalized_: false,\n    // Track which properties have been assigned (true) or deleted (false).\n    assigned_: {},\n    // The parent draft state.\n    parent_: parent,\n    // The base state.\n    base_: base,\n    // The base proxy.\n    draft_: null,\n    // set below\n    // The base copy with any updated values.\n    copy_: null,\n    // Called by the `produce` function.\n    revoke_: null,\n    isManual_: false\n  };\n  let target = state;\n  let traps = objectTraps;\n  if (isArray) {\n    target = [state];\n    traps = arrayTraps;\n  }\n  const { revoke, proxy } = Proxy.revocable(target, traps);\n  state.draft_ = proxy;\n  state.revoke_ = revoke;\n  return proxy;\n}\nvar objectTraps = {\n  get(state, prop) {\n    if (prop === DRAFT_STATE)\n      return state;\n    const source = latest(state);\n    if (!has(source, prop)) {\n      return readPropFromProto(state, source, prop);\n    }\n    const value = source[prop];\n    if (state.finalized_ || !isDraftable(value)) {\n      return value;\n    }\n    if (value === peek(state.base_, prop)) {\n      prepareCopy(state);\n      return state.copy_[prop] = createProxy(value, state);\n    }\n    return value;\n  },\n  has(state, prop) {\n    return prop in latest(state);\n  },\n  ownKeys(state) {\n    return Reflect.ownKeys(latest(state));\n  },\n  set(state, prop, value) {\n    const desc = getDescriptorFromProto(latest(state), prop);\n    if (desc?.set) {\n      desc.set.call(state.draft_, value);\n      return true;\n    }\n    if (!state.modified_) {\n      const current2 = peek(latest(state), prop);\n      const currentState = current2?.[DRAFT_STATE];\n      if (currentState && currentState.base_ === value) {\n        state.copy_[prop] = value;\n        state.assigned_[prop] = false;\n        return true;\n      }\n      if (is(value, current2) && (value !== void 0 || has(state.base_, prop)))\n        return true;\n      prepareCopy(state);\n      markChanged(state);\n    }\n    if (state.copy_[prop] === value && // special case: handle new props with value 'undefined'\n    (value !== void 0 || prop in state.copy_) || // special case: NaN\n    Number.isNaN(value) && Number.isNaN(state.copy_[prop]))\n      return true;\n    state.copy_[prop] = value;\n    state.assigned_[prop] = true;\n    return true;\n  },\n  deleteProperty(state, prop) {\n    if (peek(state.base_, prop) !== void 0 || prop in state.base_) {\n      state.assigned_[prop] = false;\n      prepareCopy(state);\n      markChanged(state);\n    } else {\n      delete state.assigned_[prop];\n    }\n    if (state.copy_) {\n      delete state.copy_[prop];\n    }\n    return true;\n  },\n  // Note: We never coerce `desc.value` into an Immer draft, because we can't make\n  // the same guarantee in ES5 mode.\n  getOwnPropertyDescriptor(state, prop) {\n    const owner = latest(state);\n    const desc = Reflect.getOwnPropertyDescriptor(owner, prop);\n    if (!desc)\n      return desc;\n    return {\n      writable: true,\n      configurable: state.type_ !== 1 /* Array */ || prop !== \"length\",\n      enumerable: desc.enumerable,\n      value: owner[prop]\n    };\n  },\n  defineProperty() {\n    die(11);\n  },\n  getPrototypeOf(state) {\n    return getPrototypeOf(state.base_);\n  },\n  setPrototypeOf() {\n    die(12);\n  }\n};\nvar arrayTraps = {};\neach(objectTraps, (key, fn) => {\n  arrayTraps[key] = function() {\n    arguments[0] = arguments[0][0];\n    return fn.apply(this, arguments);\n  };\n});\narrayTraps.deleteProperty = function(state, prop) {\n  if (process.env.NODE_ENV !== \"production\" && isNaN(parseInt(prop)))\n    die(13);\n  return arrayTraps.set.call(this, state, prop, void 0);\n};\narrayTraps.set = function(state, prop, value) {\n  if (process.env.NODE_ENV !== \"production\" && prop !== \"length\" && isNaN(parseInt(prop)))\n    die(14);\n  return objectTraps.set.call(this, state[0], prop, value, state[0]);\n};\nfunction peek(draft, prop) {\n  const state = draft[DRAFT_STATE];\n  const source = state ? latest(state) : draft;\n  return source[prop];\n}\nfunction readPropFromProto(state, source, prop) {\n  const desc = getDescriptorFromProto(source, prop);\n  return desc ? `value` in desc ? desc.value : (\n    // This is a very special case, if the prop is a getter defined by the\n    // prototype, we should invoke it with the draft as context!\n    desc.get?.call(state.draft_)\n  ) : void 0;\n}\nfunction getDescriptorFromProto(source, prop) {\n  if (!(prop in source))\n    return void 0;\n  let proto = getPrototypeOf(source);\n  while (proto) {\n    const desc = Object.getOwnPropertyDescriptor(proto, prop);\n    if (desc)\n      return desc;\n    proto = getPrototypeOf(proto);\n  }\n  return void 0;\n}\nfunction markChanged(state) {\n  if (!state.modified_) {\n    state.modified_ = true;\n    if (state.parent_) {\n      markChanged(state.parent_);\n    }\n  }\n}\nfunction prepareCopy(state) {\n  if (!state.copy_) {\n    state.copy_ = shallowCopy(\n      state.base_,\n      state.scope_.immer_.useStrictShallowCopy_\n    );\n  }\n}\n\n// src/core/immerClass.ts\nvar Immer2 = class {\n  constructor(config) {\n    this.autoFreeze_ = true;\n    this.useStrictShallowCopy_ = false;\n    /**\n     * The `produce` function takes a value and a \"recipe function\" (whose\n     * return value often depends on the base state). The recipe function is\n     * free to mutate its first argument however it wants. All mutations are\n     * only ever applied to a __copy__ of the base state.\n     *\n     * Pass only a function to create a \"curried producer\" which relieves you\n     * from passing the recipe function every time.\n     *\n     * Only plain objects and arrays are made mutable. All other objects are\n     * considered uncopyable.\n     *\n     * Note: This function is __bound__ to its `Immer` instance.\n     *\n     * @param {any} base - the initial state\n     * @param {Function} recipe - function that receives a proxy of the base state as first argument and which can be freely modified\n     * @param {Function} patchListener - optional function that will be called with all the patches produced here\n     * @returns {any} a new state, or the initial state if nothing was modified\n     */\n    this.produce = (base, recipe, patchListener) => {\n      if (typeof base === \"function\" && typeof recipe !== \"function\") {\n        const defaultBase = recipe;\n        recipe = base;\n        const self = this;\n        return function curriedProduce(base2 = defaultBase, ...args) {\n          return self.produce(base2, (draft) => recipe.call(this, draft, ...args));\n        };\n      }\n      if (typeof recipe !== \"function\")\n        die(6);\n      if (patchListener !== void 0 && typeof patchListener !== \"function\")\n        die(7);\n      let result;\n      if (isDraftable(base)) {\n        const scope = enterScope(this);\n        const proxy = createProxy(base, void 0);\n        let hasError = true;\n        try {\n          result = recipe(proxy);\n          hasError = false;\n        } finally {\n          if (hasError)\n            revokeScope(scope);\n          else\n            leaveScope(scope);\n        }\n        usePatchesInScope(scope, patchListener);\n        return processResult(result, scope);\n      } else if (!base || typeof base !== \"object\") {\n        result = recipe(base);\n        if (result === void 0)\n          result = base;\n        if (result === NOTHING)\n          result = void 0;\n        if (this.autoFreeze_)\n          freeze(result, true);\n        if (patchListener) {\n          const p = [];\n          const ip = [];\n          getPlugin(\"Patches\").generateReplacementPatches_(base, result, p, ip);\n          patchListener(p, ip);\n        }\n        return result;\n      } else\n        die(1, base);\n    };\n    this.produceWithPatches = (base, recipe) => {\n      if (typeof base === \"function\") {\n        return (state, ...args) => this.produceWithPatches(state, (draft) => base(draft, ...args));\n      }\n      let patches, inversePatches;\n      const result = this.produce(base, recipe, (p, ip) => {\n        patches = p;\n        inversePatches = ip;\n      });\n      return [result, patches, inversePatches];\n    };\n    if (typeof config?.autoFreeze === \"boolean\")\n      this.setAutoFreeze(config.autoFreeze);\n    if (typeof config?.useStrictShallowCopy === \"boolean\")\n      this.setUseStrictShallowCopy(config.useStrictShallowCopy);\n  }\n  createDraft(base) {\n    if (!isDraftable(base))\n      die(8);\n    if (isDraft(base))\n      base = current(base);\n    const scope = enterScope(this);\n    const proxy = createProxy(base, void 0);\n    proxy[DRAFT_STATE].isManual_ = true;\n    leaveScope(scope);\n    return proxy;\n  }\n  finishDraft(draft, patchListener) {\n    const state = draft && draft[DRAFT_STATE];\n    if (!state || !state.isManual_)\n      die(9);\n    const { scope_: scope } = state;\n    usePatchesInScope(scope, patchListener);\n    return processResult(void 0, scope);\n  }\n  /**\n   * Pass true to automatically freeze all copies created by Immer.\n   *\n   * By default, auto-freezing is enabled.\n   */\n  setAutoFreeze(value) {\n    this.autoFreeze_ = value;\n  }\n  /**\n   * Pass true to enable strict shallow copy.\n   *\n   * By default, immer does not copy the object descriptors such as getter, setter and non-enumrable properties.\n   */\n  setUseStrictShallowCopy(value) {\n    this.useStrictShallowCopy_ = value;\n  }\n  applyPatches(base, patches) {\n    let i;\n    for (i = patches.length - 1; i >= 0; i--) {\n      const patch = patches[i];\n      if (patch.path.length === 0 && patch.op === \"replace\") {\n        base = patch.value;\n        break;\n      }\n    }\n    if (i > -1) {\n      patches = patches.slice(i + 1);\n    }\n    const applyPatchesImpl = getPlugin(\"Patches\").applyPatches_;\n    if (isDraft(base)) {\n      return applyPatchesImpl(base, patches);\n    }\n    return this.produce(\n      base,\n      (draft) => applyPatchesImpl(draft, patches)\n    );\n  }\n};\nfunction createProxy(value, parent) {\n  const draft = isMap(value) ? getPlugin(\"MapSet\").proxyMap_(value, parent) : isSet(value) ? getPlugin(\"MapSet\").proxySet_(value, parent) : createProxyProxy(value, parent);\n  const scope = parent ? parent.scope_ : getCurrentScope();\n  scope.drafts_.push(draft);\n  return draft;\n}\n\n// src/core/current.ts\nfunction current(value) {\n  if (!isDraft(value))\n    die(10, value);\n  return currentImpl(value);\n}\nfunction currentImpl(value) {\n  if (!isDraftable(value) || isFrozen(value))\n    return value;\n  const state = value[DRAFT_STATE];\n  let copy;\n  if (state) {\n    if (!state.modified_)\n      return state.base_;\n    state.finalized_ = true;\n    copy = shallowCopy(value, state.scope_.immer_.useStrictShallowCopy_);\n  } else {\n    copy = shallowCopy(value, true);\n  }\n  each(copy, (key, childValue) => {\n    set(copy, key, currentImpl(childValue));\n  });\n  if (state) {\n    state.finalized_ = false;\n  }\n  return copy;\n}\n\n// src/plugins/patches.ts\nfunction enablePatches() {\n  const errorOffset = 16;\n  if (process.env.NODE_ENV !== \"production\") {\n    errors.push(\n      'Sets cannot have \"replace\" patches.',\n      function(op) {\n        return \"Unsupported patch operation: \" + op;\n      },\n      function(path) {\n        return \"Cannot apply patch, path doesn't resolve: \" + path;\n      },\n      \"Patching reserved attributes like __proto__, prototype and constructor is not allowed\"\n    );\n  }\n  const REPLACE = \"replace\";\n  const ADD = \"add\";\n  const REMOVE = \"remove\";\n  function generatePatches_(state, basePath, patches, inversePatches) {\n    switch (state.type_) {\n      case 0 /* Object */:\n      case 2 /* Map */:\n        return generatePatchesFromAssigned(\n          state,\n          basePath,\n          patches,\n          inversePatches\n        );\n      case 1 /* Array */:\n        return generateArrayPatches(state, basePath, patches, inversePatches);\n      case 3 /* Set */:\n        return generateSetPatches(\n          state,\n          basePath,\n          patches,\n          inversePatches\n        );\n    }\n  }\n  function generateArrayPatches(state, basePath, patches, inversePatches) {\n    let { base_, assigned_ } = state;\n    let copy_ = state.copy_;\n    if (copy_.length < base_.length) {\n      ;\n      [base_, copy_] = [copy_, base_];\n      [patches, inversePatches] = [inversePatches, patches];\n    }\n    for (let i = 0; i < base_.length; i++) {\n      if (assigned_[i] && copy_[i] !== base_[i]) {\n        const path = basePath.concat([i]);\n        patches.push({\n          op: REPLACE,\n          path,\n          // Need to maybe clone it, as it can in fact be the original value\n          // due to the base/copy inversion at the start of this function\n          value: clonePatchValueIfNeeded(copy_[i])\n        });\n        inversePatches.push({\n          op: REPLACE,\n          path,\n          value: clonePatchValueIfNeeded(base_[i])\n        });\n      }\n    }\n    for (let i = base_.length; i < copy_.length; i++) {\n      const path = basePath.concat([i]);\n      patches.push({\n        op: ADD,\n        path,\n        // Need to maybe clone it, as it can in fact be the original value\n        // due to the base/copy inversion at the start of this function\n        value: clonePatchValueIfNeeded(copy_[i])\n      });\n    }\n    for (let i = copy_.length - 1; base_.length <= i; --i) {\n      const path = basePath.concat([i]);\n      inversePatches.push({\n        op: REMOVE,\n        path\n      });\n    }\n  }\n  function generatePatchesFromAssigned(state, basePath, patches, inversePatches) {\n    const { base_, copy_ } = state;\n    each(state.assigned_, (key, assignedValue) => {\n      const origValue = get(base_, key);\n      const value = get(copy_, key);\n      const op = !assignedValue ? REMOVE : has(base_, key) ? REPLACE : ADD;\n      if (origValue === value && op === REPLACE)\n        return;\n      const path = basePath.concat(key);\n      patches.push(op === REMOVE ? { op, path } : { op, path, value });\n      inversePatches.push(\n        op === ADD ? { op: REMOVE, path } : op === REMOVE ? { op: ADD, path, value: clonePatchValueIfNeeded(origValue) } : { op: REPLACE, path, value: clonePatchValueIfNeeded(origValue) }\n      );\n    });\n  }\n  function generateSetPatches(state, basePath, patches, inversePatches) {\n    let { base_, copy_ } = state;\n    let i = 0;\n    base_.forEach((value) => {\n      if (!copy_.has(value)) {\n        const path = basePath.concat([i]);\n        patches.push({\n          op: REMOVE,\n          path,\n          value\n        });\n        inversePatches.unshift({\n          op: ADD,\n          path,\n          value\n        });\n      }\n      i++;\n    });\n    i = 0;\n    copy_.forEach((value) => {\n      if (!base_.has(value)) {\n        const path = basePath.concat([i]);\n        patches.push({\n          op: ADD,\n          path,\n          value\n        });\n        inversePatches.unshift({\n          op: REMOVE,\n          path,\n          value\n        });\n      }\n      i++;\n    });\n  }\n  function generateReplacementPatches_(baseValue, replacement, patches, inversePatches) {\n    patches.push({\n      op: REPLACE,\n      path: [],\n      value: replacement === NOTHING ? void 0 : replacement\n    });\n    inversePatches.push({\n      op: REPLACE,\n      path: [],\n      value: baseValue\n    });\n  }\n  function applyPatches_(draft, patches) {\n    patches.forEach((patch) => {\n      const { path, op } = patch;\n      let base = draft;\n      for (let i = 0; i < path.length - 1; i++) {\n        const parentType = getArchtype(base);\n        let p = path[i];\n        if (typeof p !== \"string\" && typeof p !== \"number\") {\n          p = \"\" + p;\n        }\n        if ((parentType === 0 /* Object */ || parentType === 1 /* Array */) && (p === \"__proto__\" || p === \"constructor\"))\n          die(errorOffset + 3);\n        if (typeof base === \"function\" && p === \"prototype\")\n          die(errorOffset + 3);\n        base = get(base, p);\n        if (typeof base !== \"object\")\n          die(errorOffset + 2, path.join(\"/\"));\n      }\n      const type = getArchtype(base);\n      const value = deepClonePatchValue(patch.value);\n      const key = path[path.length - 1];\n      switch (op) {\n        case REPLACE:\n          switch (type) {\n            case 2 /* Map */:\n              return base.set(key, value);\n            case 3 /* Set */:\n              die(errorOffset);\n            default:\n              return base[key] = value;\n          }\n        case ADD:\n          switch (type) {\n            case 1 /* Array */:\n              return key === \"-\" ? base.push(value) : base.splice(key, 0, value);\n            case 2 /* Map */:\n              return base.set(key, value);\n            case 3 /* Set */:\n              return base.add(value);\n            default:\n              return base[key] = value;\n          }\n        case REMOVE:\n          switch (type) {\n            case 1 /* Array */:\n              return base.splice(key, 1);\n            case 2 /* Map */:\n              return base.delete(key);\n            case 3 /* Set */:\n              return base.delete(patch.value);\n            default:\n              return delete base[key];\n          }\n        default:\n          die(errorOffset + 1, op);\n      }\n    });\n    return draft;\n  }\n  function deepClonePatchValue(obj) {\n    if (!isDraftable(obj))\n      return obj;\n    if (Array.isArray(obj))\n      return obj.map(deepClonePatchValue);\n    if (isMap(obj))\n      return new Map(\n        Array.from(obj.entries()).map(([k, v]) => [k, deepClonePatchValue(v)])\n      );\n    if (isSet(obj))\n      return new Set(Array.from(obj).map(deepClonePatchValue));\n    const cloned = Object.create(getPrototypeOf(obj));\n    for (const key in obj)\n      cloned[key] = deepClonePatchValue(obj[key]);\n    if (has(obj, DRAFTABLE))\n      cloned[DRAFTABLE] = obj[DRAFTABLE];\n    return cloned;\n  }\n  function clonePatchValueIfNeeded(obj) {\n    if (isDraft(obj)) {\n      return deepClonePatchValue(obj);\n    } else\n      return obj;\n  }\n  loadPlugin(\"Patches\", {\n    applyPatches_,\n    generatePatches_,\n    generateReplacementPatches_\n  });\n}\n\n// src/plugins/mapset.ts\nfunction enableMapSet() {\n  class DraftMap extends Map {\n    constructor(target, parent) {\n      super();\n      this[DRAFT_STATE] = {\n        type_: 2 /* Map */,\n        parent_: parent,\n        scope_: parent ? parent.scope_ : getCurrentScope(),\n        modified_: false,\n        finalized_: false,\n        copy_: void 0,\n        assigned_: void 0,\n        base_: target,\n        draft_: this,\n        isManual_: false,\n        revoked_: false\n      };\n    }\n    get size() {\n      return latest(this[DRAFT_STATE]).size;\n    }\n    has(key) {\n      return latest(this[DRAFT_STATE]).has(key);\n    }\n    set(key, value) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (!latest(state).has(key) || latest(state).get(key) !== value) {\n        prepareMapCopy(state);\n        markChanged(state);\n        state.assigned_.set(key, true);\n        state.copy_.set(key, value);\n        state.assigned_.set(key, true);\n      }\n      return this;\n    }\n    delete(key) {\n      if (!this.has(key)) {\n        return false;\n      }\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareMapCopy(state);\n      markChanged(state);\n      if (state.base_.has(key)) {\n        state.assigned_.set(key, false);\n      } else {\n        state.assigned_.delete(key);\n      }\n      state.copy_.delete(key);\n      return true;\n    }\n    clear() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (latest(state).size) {\n        prepareMapCopy(state);\n        markChanged(state);\n        state.assigned_ = /* @__PURE__ */ new Map();\n        each(state.base_, (key) => {\n          state.assigned_.set(key, false);\n        });\n        state.copy_.clear();\n      }\n    }\n    forEach(cb, thisArg) {\n      const state = this[DRAFT_STATE];\n      latest(state).forEach((_value, key, _map) => {\n        cb.call(thisArg, this.get(key), key, this);\n      });\n    }\n    get(key) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      const value = latest(state).get(key);\n      if (state.finalized_ || !isDraftable(value)) {\n        return value;\n      }\n      if (value !== state.base_.get(key)) {\n        return value;\n      }\n      const draft = createProxy(value, state);\n      prepareMapCopy(state);\n      state.copy_.set(key, draft);\n      return draft;\n    }\n    keys() {\n      return latest(this[DRAFT_STATE]).keys();\n    }\n    values() {\n      const iterator = this.keys();\n      return {\n        [Symbol.iterator]: () => this.values(),\n        next: () => {\n          const r = iterator.next();\n          if (r.done)\n            return r;\n          const value = this.get(r.value);\n          return {\n            done: false,\n            value\n          };\n        }\n      };\n    }\n    entries() {\n      const iterator = this.keys();\n      return {\n        [Symbol.iterator]: () => this.entries(),\n        next: () => {\n          const r = iterator.next();\n          if (r.done)\n            return r;\n          const value = this.get(r.value);\n          return {\n            done: false,\n            value: [r.value, value]\n          };\n        }\n      };\n    }\n    [(DRAFT_STATE, Symbol.iterator)]() {\n      return this.entries();\n    }\n  }\n  function proxyMap_(target, parent) {\n    return new DraftMap(target, parent);\n  }\n  function prepareMapCopy(state) {\n    if (!state.copy_) {\n      state.assigned_ = /* @__PURE__ */ new Map();\n      state.copy_ = new Map(state.base_);\n    }\n  }\n  class DraftSet extends Set {\n    constructor(target, parent) {\n      super();\n      this[DRAFT_STATE] = {\n        type_: 3 /* Set */,\n        parent_: parent,\n        scope_: parent ? parent.scope_ : getCurrentScope(),\n        modified_: false,\n        finalized_: false,\n        copy_: void 0,\n        base_: target,\n        draft_: this,\n        drafts_: /* @__PURE__ */ new Map(),\n        revoked_: false,\n        isManual_: false\n      };\n    }\n    get size() {\n      return latest(this[DRAFT_STATE]).size;\n    }\n    has(value) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (!state.copy_) {\n        return state.base_.has(value);\n      }\n      if (state.copy_.has(value))\n        return true;\n      if (state.drafts_.has(value) && state.copy_.has(state.drafts_.get(value)))\n        return true;\n      return false;\n    }\n    add(value) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (!this.has(value)) {\n        prepareSetCopy(state);\n        markChanged(state);\n        state.copy_.add(value);\n      }\n      return this;\n    }\n    delete(value) {\n      if (!this.has(value)) {\n        return false;\n      }\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareSetCopy(state);\n      markChanged(state);\n      return state.copy_.delete(value) || (state.drafts_.has(value) ? state.copy_.delete(state.drafts_.get(value)) : (\n        /* istanbul ignore next */\n        false\n      ));\n    }\n    clear() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (latest(state).size) {\n        prepareSetCopy(state);\n        markChanged(state);\n        state.copy_.clear();\n      }\n    }\n    values() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareSetCopy(state);\n      return state.copy_.values();\n    }\n    entries() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareSetCopy(state);\n      return state.copy_.entries();\n    }\n    keys() {\n      return this.values();\n    }\n    [(DRAFT_STATE, Symbol.iterator)]() {\n      return this.values();\n    }\n    forEach(cb, thisArg) {\n      const iterator = this.values();\n      let result = iterator.next();\n      while (!result.done) {\n        cb.call(thisArg, result.value, result.value, this);\n        result = iterator.next();\n      }\n    }\n  }\n  function proxySet_(target, parent) {\n    return new DraftSet(target, parent);\n  }\n  function prepareSetCopy(state) {\n    if (!state.copy_) {\n      state.copy_ = /* @__PURE__ */ new Set();\n      state.base_.forEach((value) => {\n        if (isDraftable(value)) {\n          const draft = createProxy(value, state);\n          state.drafts_.set(value, draft);\n          state.copy_.add(draft);\n        } else {\n          state.copy_.add(value);\n        }\n      });\n    }\n  }\n  function assertUnrevoked(state) {\n    if (state.revoked_)\n      die(3, JSON.stringify(latest(state)));\n  }\n  loadPlugin(\"MapSet\", { proxyMap_, proxySet_ });\n}\n\n// src/immer.ts\nvar immer = new Immer2();\nvar produce = immer.produce;\nvar produceWithPatches = immer.produceWithPatches.bind(\n  immer\n);\nvar setAutoFreeze = immer.setAutoFreeze.bind(immer);\nvar setUseStrictShallowCopy = immer.setUseStrictShallowCopy.bind(immer);\nvar applyPatches = immer.applyPatches.bind(immer);\nvar createDraft = immer.createDraft.bind(immer);\nvar finishDraft = immer.finishDraft.bind(immer);\nfunction castDraft(value) {\n  return value;\n}\nfunction castImmutable(value) {\n  return value;\n}\nexport {\n  Immer2 as Immer,\n  applyPatches,\n  castDraft,\n  castImmutable,\n  createDraft,\n  current,\n  enableMapSet,\n  enablePatches,\n  finishDraft,\n  freeze,\n  DRAFTABLE as immerable,\n  isDraft,\n  isDraftable,\n  NOTHING as nothing,\n  original,\n  produce,\n  produceWithPatches,\n  setAutoFreeze,\n  setUseStrictShallowCopy\n};\n//# sourceMappingURL=immer.mjs.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { enablePatches, produceWithPatches } from \"immer\";\nenablePatches();\nclass SceneItemsApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    getItems(filter) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (Array.isArray(filter)) {\n                const { items } = yield this.messageBus.sendAsync(\"OBR_SCENE_ITEMS_GET_ITEMS\", { ids: filter });\n                return items;\n            }\n            else if (filter) {\n                const { items } = yield this.messageBus.sendAsync(\"OBR_SCENE_ITEMS_GET_ALL_ITEMS\", {});\n                return items.filter(filter);\n            }\n            else {\n                const { items } = yield this.messageBus.sendAsync(\"OBR_SCENE_ITEMS_GET_ALL_ITEMS\", {});\n                return items;\n            }\n        });\n    }\n    isItemArray(value) {\n        return (Array.isArray(value) && value.every((item) => typeof item !== \"string\"));\n    }\n    updateItems(filterOrItems, update) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let items;\n            if (this.isItemArray(filterOrItems)) {\n                items = filterOrItems;\n            }\n            else {\n                items = yield this.getItems(filterOrItems);\n            }\n            const [nextState, patches] = produceWithPatches(items, update);\n            const nextUpdates = nextState.map((item) => ({\n                id: item.id,\n                type: item.type,\n            }));\n            // Use patches to get the partial update keys\n            for (const patch of patches) {\n                const [index, key] = patch.path;\n                if (typeof index === \"number\" && typeof key === \"string\") {\n                    nextUpdates[index][key] = nextState[index][key];\n                }\n            }\n            // Filter out any update without changes\n            const updates = nextUpdates.filter(\n            // Ensure that there are updates besides the default ID and type\n            (update) => Object.keys(update).length > 2);\n            if (updates.length === 0) {\n                return;\n            }\n            yield this.messageBus.sendAsync(\"OBR_SCENE_ITEMS_UPDATE_ITEMS\", {\n                updates,\n            });\n        });\n    }\n    addItems(items) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_ITEMS_ADD_ITEMS\", {\n                items,\n            });\n        });\n    }\n    deleteItems(ids) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_ITEMS_DELETE_ITEMS\", {\n                ids,\n            });\n        });\n    }\n    getItemAttachments(ids) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { items } = yield this.messageBus.sendAsync(\"OBR_SCENE_ITEMS_GET_ITEM_ATTACHMENTS\", { ids });\n            return items;\n        });\n    }\n    getItemBounds(ids) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { bounds } = yield this.messageBus.sendAsync(\"OBR_SCENE_ITEMS_GET_ITEM_BOUNDS\", { ids });\n            return bounds;\n        });\n    }\n    onChange(callback) {\n        const handleChange = (data) => {\n            callback(data.items);\n        };\n        this.messageBus.send(\"OBR_SCENE_ITEMS_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_SCENE_ITEMS_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_SCENE_ITEMS_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_SCENE_ITEMS_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default SceneItemsApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { enablePatches, produceWithPatches } from \"immer\";\nenablePatches();\nclass SceneLocalApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    getItems(filter) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (Array.isArray(filter)) {\n                const { items } = yield this.messageBus.sendAsync(\"OBR_SCENE_LOCAL_GET_ITEMS\", { ids: filter });\n                return items;\n            }\n            else if (filter) {\n                const { items } = yield this.messageBus.sendAsync(\"OBR_SCENE_LOCAL_GET_ALL_ITEMS\", {});\n                return items.filter(filter);\n            }\n            else {\n                const { items } = yield this.messageBus.sendAsync(\"OBR_SCENE_LOCAL_GET_ALL_ITEMS\", {});\n                return items;\n            }\n        });\n    }\n    isItemArray(value) {\n        return (Array.isArray(value) && value.every((item) => typeof item !== \"string\"));\n    }\n    updateItems(filterOrItems, update, fastUpdate) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let items;\n            if (this.isItemArray(filterOrItems)) {\n                items = filterOrItems;\n            }\n            else {\n                items = yield this.getItems(filterOrItems);\n            }\n            const [nextState, patches] = produceWithPatches(items, update);\n            const nextUpdates = nextState.map((item) => ({\n                id: item.id,\n                type: item.type,\n            }));\n            // Use patches to get the partial update keys\n            for (const patch of patches) {\n                const [index, key] = patch.path;\n                if (typeof index === \"number\" && typeof key === \"string\") {\n                    nextUpdates[index][key] = nextState[index][key];\n                }\n            }\n            // Filter out any update without changes\n            const updates = nextUpdates.filter(\n            // Ensure that there are updates besides the default ID and type\n            (update) => Object.keys(update).length > 2);\n            if (updates.length === 0) {\n                return;\n            }\n            yield this.messageBus.sendAsync(\"OBR_SCENE_LOCAL_UPDATE_ITEMS\", {\n                updates,\n                fastUpdate,\n            });\n        });\n    }\n    addItems(items) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_LOCAL_ADD_ITEMS\", {\n                items,\n            });\n        });\n    }\n    deleteItems(ids) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_LOCAL_DELETE_ITEMS\", {\n                ids,\n            });\n        });\n    }\n    getItemAttachments(ids) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { items } = yield this.messageBus.sendAsync(\"OBR_SCENE_LOCAL_GET_ITEM_ATTACHMENTS\", { ids });\n            return items;\n        });\n    }\n    getItemBounds(ids) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { bounds } = yield this.messageBus.sendAsync(\"OBR_SCENE_LOCAL_GET_ITEM_BOUNDS\", { ids });\n            return bounds;\n        });\n    }\n    onChange(callback) {\n        const handleChange = (data) => {\n            callback(data.items);\n        };\n        this.messageBus.send(\"OBR_SCENE_LOCAL_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_SCENE_LOCAL_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_SCENE_LOCAL_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_SCENE_LOCAL_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default SceneLocalApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport SceneFogApi from \"./SceneFogApi\";\nimport SceneGridApi from \"./SceneGridApi\";\nimport SceneHistoryApi from \"./SceneHistoryApi\";\nimport SceneItemsApi from \"./SceneItemsApi\";\nimport SceneLocalApi from \"./SceneLocalApi\";\nclass SceneApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n        this.grid = new SceneGridApi(messageBus);\n        this.fog = new SceneFogApi(messageBus);\n        this.history = new SceneHistoryApi(messageBus);\n        this.items = new SceneItemsApi(messageBus);\n        this.local = new SceneLocalApi(messageBus);\n    }\n    isReady() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { ready } = yield this.messageBus.sendAsync(\"OBR_SCENE_IS_READY\", {});\n            return ready;\n        });\n    }\n    onReadyChange(callback) {\n        const handleChange = (data) => {\n            callback(data.ready);\n        };\n        this.messageBus.send(\"OBR_SCENE_READY_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_SCENE_EVENT_READY_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_SCENE_READY_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_SCENE_EVENT_READY_CHANGE\", handleChange);\n        };\n    }\n    getMetadata() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { metadata } = yield this.messageBus.sendAsync(\"OBR_SCENE_GET_METADATA\", {});\n            return metadata;\n        });\n    }\n    setMetadata(update) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_SCENE_SET_METADATA\", { update });\n        });\n    }\n    onMetadataChange(callback) {\n        const handleChange = (data) => {\n            callback(data.metadata);\n        };\n        this.messageBus.send(\"OBR_SCENE_METADATA_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_SCENE_METADATA_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_SCENE_METADATA_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_SCENE_METADATA_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default SceneApi;\n","export function normalizeUrl(url) {\n    return url.startsWith(\"http\") ? url : `${window.location.origin}${url}`;\n}\n/**\n * Normalize icon paths so that relative paths are transformed into absolute paths\n */\nexport function normalizeIconPaths(icons) {\n    return icons.map((base) => (Object.assign(Object.assign({}, base), { icon: normalizeUrl(base.icon) })));\n}\n/**\n * Normalize an object with a url property so that relative paths are transformed into absolute paths\n */\nexport function normalizeUrlObject(urlObject) {\n    return Object.assign(Object.assign({}, urlObject), { url: normalizeUrl(urlObject.url) });\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { normalizeIconPaths, normalizeUrlObject } from \"../common/normalize\";\nclass ContextMenuApi {\n    constructor(messageBus) {\n        this.contextMenus = {};\n        this.handleClick = (event) => {\n            var _a;\n            const menu = this.contextMenus[event.id];\n            if (menu) {\n                (_a = menu.onClick) === null || _a === void 0 ? void 0 : _a.call(menu, event.context, event.elementId);\n            }\n        };\n        this.messageBus = messageBus;\n        messageBus.on(\"OBR_CONTEXT_MENU_EVENT_CLICK\", this.handleClick);\n    }\n    create(contextMenu) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.messageBus.sendAsync(\"OBR_CONTEXT_MENU_CREATE\", {\n                id: contextMenu.id,\n                shortcut: contextMenu.shortcut,\n                icons: normalizeIconPaths(contextMenu.icons),\n                embed: contextMenu.embed && normalizeUrlObject(contextMenu.embed),\n            });\n            this.contextMenus[contextMenu.id] = contextMenu;\n        });\n    }\n    remove(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_CONTEXT_MENU_REMOVE\", { id });\n            delete this.contextMenus[id];\n        });\n    }\n}\nexport default ContextMenuApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { normalizeIconPaths } from \"../common/normalize\";\nclass ToolApi {\n    constructor(messageBus) {\n        this.tools = {};\n        this.toolActions = {};\n        this.toolModes = {};\n        this.handleToolClick = (event) => {\n            const tool = this.tools[event.id];\n            if (tool) {\n                if (tool.onClick) {\n                    const result = tool.onClick(event.context, event.elementId);\n                    Promise.resolve(result).then((activate) => {\n                        if (activate) {\n                            this.messageBus.send(\"OBR_TOOL_ACTIVATE\", {\n                                id: event.id,\n                            });\n                        }\n                    });\n                }\n                else {\n                    this.messageBus.send(\"OBR_TOOL_ACTIVATE\", {\n                        id: event.id,\n                    });\n                }\n            }\n        };\n        this.handleToolActionClick = (event) => {\n            var _a;\n            const action = this.toolActions[event.id];\n            if (action) {\n                (_a = action.onClick) === null || _a === void 0 ? void 0 : _a.call(action, event.context, event.elementId);\n            }\n        };\n        this.handleToolModeClick = (event) => {\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                if (mode.onClick) {\n                    const result = mode.onClick(event.context, event.elementId);\n                    Promise.resolve(result).then((activate) => {\n                        if (activate) {\n                            this.messageBus.send(\"OBR_TOOL_MODE_ACTIVATE\", {\n                                toolId: event.context.activeTool,\n                                modeId: event.id,\n                            });\n                        }\n                    });\n                }\n                else {\n                    this.messageBus.send(\"OBR_TOOL_MODE_ACTIVATE\", {\n                        toolId: event.context.activeTool,\n                        modeId: event.id,\n                    });\n                }\n            }\n        };\n        this.handleToolModeToolClick = (event) => {\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                if (mode.onToolClick) {\n                    const result = mode.onToolClick(event.context, event.event);\n                    Promise.resolve(result).then((select) => {\n                        if (select && event.event.target && !event.event.target.locked) {\n                            this.messageBus.sendAsync(\"OBR_PLAYER_SELECT\", {\n                                items: [event.event.target.id],\n                            });\n                        }\n                    });\n                }\n                else {\n                    if (event.event.target && !event.event.target.locked) {\n                        this.messageBus.sendAsync(\"OBR_PLAYER_SELECT\", {\n                            items: [event.event.target.id],\n                        });\n                    }\n                }\n            }\n        };\n        this.handleToolModeToolDoubleClick = (event) => {\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                if (mode.onToolDoubleClick) {\n                    const result = mode.onToolDoubleClick(event.context, event.event);\n                    Promise.resolve(result).then((select) => {\n                        if (select && event.event.target) {\n                            this.messageBus.sendAsync(\"OBR_PLAYER_SELECT\", {\n                                items: [event.event.target.id],\n                            });\n                        }\n                    });\n                }\n                else {\n                    if (event.event.target) {\n                        this.messageBus.sendAsync(\"OBR_PLAYER_SELECT\", {\n                            items: [event.event.target.id],\n                        });\n                    }\n                }\n            }\n        };\n        this.handleToolModeToolDown = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onToolDown) === null || _a === void 0 ? void 0 : _a.call(mode, event.context, event.event);\n            }\n        };\n        this.handleToolModeToolMove = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onToolMove) === null || _a === void 0 ? void 0 : _a.call(mode, event.context, event.event);\n            }\n        };\n        this.handleToolModeToolUp = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onToolUp) === null || _a === void 0 ? void 0 : _a.call(mode, event.context, event.event);\n            }\n        };\n        this.handleToolModeToolDragStart = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onToolDragStart) === null || _a === void 0 ? void 0 : _a.call(mode, event.context, event.event);\n            }\n        };\n        this.handleToolModeToolDragMove = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onToolDragMove) === null || _a === void 0 ? void 0 : _a.call(mode, event.context, event.event);\n            }\n        };\n        this.handleToolModeToolDragEnd = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onToolDragEnd) === null || _a === void 0 ? void 0 : _a.call(mode, event.context, event.event);\n            }\n        };\n        this.handleToolModeToolDragCancel = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onToolDragCancel) === null || _a === void 0 ? void 0 : _a.call(mode, event.context, event.event);\n            }\n        };\n        this.handleToolModeKeyDown = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onKeyDown) === null || _a === void 0 ? void 0 : _a.call(mode, event.context, event.event);\n            }\n        };\n        this.handleToolModeKeyUp = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onKeyUp) === null || _a === void 0 ? void 0 : _a.call(mode, event.context, event.event);\n            }\n        };\n        this.handleToolModeActivate = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onActivate) === null || _a === void 0 ? void 0 : _a.call(mode, event.context);\n            }\n        };\n        this.handleToolModeDeactivate = (event) => {\n            var _a;\n            const mode = this.toolModes[event.id];\n            if (mode) {\n                (_a = mode.onDeactivate) === null || _a === void 0 ? void 0 : _a.call(mode, event.context);\n            }\n        };\n        this.messageBus = messageBus;\n        messageBus.on(\"OBR_TOOL_EVENT_CLICK\", this.handleToolClick);\n        messageBus.on(\"OBR_TOOL_ACTION_EVENT_CLICK\", this.handleToolActionClick);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_CLICK\", this.handleToolModeClick);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_TOOL_CLICK\", this.handleToolModeToolClick);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_TOOL_DOUBLE_CLICK\", this.handleToolModeToolDoubleClick);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_TOOL_DOWN\", this.handleToolModeToolDown);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_TOOL_MOVE\", this.handleToolModeToolMove);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_TOOL_UP\", this.handleToolModeToolUp);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_TOOL_DRAG_START\", this.handleToolModeToolDragStart);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_TOOL_DRAG_MOVE\", this.handleToolModeToolDragMove);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_TOOL_DRAG_END\", this.handleToolModeToolDragEnd);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_TOOL_DRAG_CANCEL\", this.handleToolModeToolDragCancel);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_KEY_DOWN\", this.handleToolModeKeyDown);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_KEY_UP\", this.handleToolModeKeyUp);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_ACTIVATE\", this.handleToolModeActivate);\n        messageBus.on(\"OBR_TOOL_MODE_EVENT_DEACTIVATE\", this.handleToolModeDeactivate);\n    }\n    create(tool) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_TOOL_CREATE\", {\n                id: tool.id,\n                shortcut: tool.shortcut,\n                defaultMode: tool.defaultMode,\n                defaultMetadata: tool.defaultMetadata,\n                icons: normalizeIconPaths(tool.icons),\n                disabled: tool.disabled,\n            });\n            this.tools[tool.id] = tool;\n        });\n    }\n    remove(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_TOOL_REMOVE\", { id });\n            delete this.tools[id];\n        });\n    }\n    activateTool(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_TOOL_ACTIVATE\", { id });\n        });\n    }\n    getActiveTool() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { id } = yield this.messageBus.sendAsync(\"OBR_TOOL_GET_ACTIVE\", {});\n            return id;\n        });\n    }\n    onToolChange(callback) {\n        const handleChange = (data) => {\n            callback(data.id);\n        };\n        this.messageBus.send(\"OBR_TOOL_ACTIVE_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_TOOL_ACTIVE_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_TOOL_ACTIVE_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_TOOL_ACTIVE_EVENT_CHANGE\", handleChange);\n        };\n    }\n    getMetadata(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { metadata } = yield this.messageBus.sendAsync(\"OBR_TOOL_GET_METADATA\", { id });\n            return metadata;\n        });\n    }\n    setMetadata(toolId, update) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_TOOL_SET_METADATA\", {\n                toolId,\n                update,\n            });\n        });\n    }\n    createAction(action) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_TOOL_ACTION_CREATE\", {\n                id: action.id,\n                shortcut: action.shortcut,\n                icons: normalizeIconPaths(action.icons),\n                disabled: action.disabled,\n            });\n            this.toolActions[action.id] = action;\n        });\n    }\n    removeAction(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_TOOL_ACTION_REMOVE\", { id });\n            delete this.tools[id];\n        });\n    }\n    createMode(mode) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_TOOL_MODE_CREATE\", {\n                id: mode.id,\n                shortcut: mode.shortcut,\n                icons: normalizeIconPaths(mode.icons),\n                preventDrag: mode.preventDrag,\n                disabled: mode.disabled,\n                cursors: mode.cursors,\n            });\n            this.toolModes[mode.id] = mode;\n        });\n    }\n    removeMode(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_TOOL_MODE_REMOVE\", { id });\n            delete this.tools[id];\n        });\n    }\n    activateMode(toolId, modeId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_TOOL_MODE_ACTIVATE\", {\n                toolId,\n                modeId,\n            });\n        });\n    }\n    getActiveToolMode() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { id } = yield this.messageBus.sendAsync(\"OBR_TOOL_MODE_GET_ACTIVE\", {});\n            return id;\n        });\n    }\n    onToolModeChange(callback) {\n        const handleChange = (data) => {\n            callback(data.id);\n        };\n        this.messageBus.send(\"OBR_TOOL_MODE_ACTIVE_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_TOOL_MODE_ACTIVE_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_TOOL_MODE_ACTIVE_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_TOOL_MODE_ACTIVE_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default ToolApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { normalizeUrlObject } from \"../common/normalize\";\nclass PopoverApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    open(popover) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_POPOVER_OPEN\", Object.assign({}, normalizeUrlObject(popover)));\n        });\n    }\n    close(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_POPOVER_CLOSE\", { id });\n        });\n    }\n    getWidth(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { width } = yield this.messageBus.sendAsync(\"OBR_POPOVER_GET_WIDTH\", { id });\n            return width;\n        });\n    }\n    setWidth(id, width) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_POPOVER_SET_WIDTH\", { id, width });\n        });\n    }\n    getHeight(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { height } = yield this.messageBus.sendAsync(\"OBR_POPOVER_GET_HEIGHT\", { id });\n            return height;\n        });\n    }\n    setHeight(id, height) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_POPOVER_SET_HEIGHT\", { id, height });\n        });\n    }\n}\nexport default PopoverApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { normalizeUrlObject } from \"../common/normalize\";\nclass ModalApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    open(modal) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_MODAL_OPEN\", Object.assign({}, normalizeUrlObject(modal)));\n        });\n    }\n    close(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_MODAL_CLOSE\", { id });\n        });\n    }\n}\nexport default ModalApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { normalizeIconPaths } from \"../common/normalize\";\nclass ActionApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    getWidth() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { width } = yield this.messageBus.sendAsync(\"OBR_ACTION_GET_WIDTH\", {});\n            return width;\n        });\n    }\n    setWidth(width) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ACTION_SET_WIDTH\", { width });\n        });\n    }\n    getHeight() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { height } = yield this.messageBus.sendAsync(\"OBR_ACTION_GET_HEIGHT\", {});\n            return height;\n        });\n    }\n    setHeight(height) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ACTION_SET_HEIGHT\", { height });\n        });\n    }\n    getBadgeText() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { badgeText } = yield this.messageBus.sendAsync(\"OBR_ACTION_GET_BADGE_TEXT\", {});\n            return badgeText;\n        });\n    }\n    setBadgeText(badgeText) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ACTION_SET_BADGE_TEXT\", { badgeText });\n        });\n    }\n    getBadgeBackgroundColor() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { badgeBackgroundColor } = yield this.messageBus.sendAsync(\"OBR_ACTION_GET_BADGE_BACKGROUND_COLOR\", {});\n            return badgeBackgroundColor;\n        });\n    }\n    setBadgeBackgroundColor(badgeBackgroundColor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ACTION_SET_BADGE_BACKGROUND_COLOR\", {\n                badgeBackgroundColor,\n            });\n        });\n    }\n    getIcon() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { icon } = yield this.messageBus.sendAsync(\"OBR_ACTION_GET_ICON\", {});\n            return icon;\n        });\n    }\n    setIcon(icon) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const data = normalizeIconPaths([{ icon }]);\n            yield this.messageBus.sendAsync(\"OBR_ACTION_SET_ICON\", {\n                icon: data[0].icon,\n            });\n        });\n    }\n    getTitle() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { title } = yield this.messageBus.sendAsync(\"OBR_ACTION_GET_TITLE\", {});\n            return title;\n        });\n    }\n    setTitle(title) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ACTION_SET_TITLE\", { title });\n        });\n    }\n    isOpen() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { isOpen } = yield this.messageBus.sendAsync(\"OBR_ACTION_GET_IS_OPEN\", {});\n            return isOpen;\n        });\n    }\n    open() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ACTION_OPEN\", {});\n        });\n    }\n    close() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ACTION_CLOSE\", {});\n        });\n    }\n    onOpenChange(callback) {\n        const handleChange = (data) => {\n            callback(data.isOpen);\n        };\n        this.messageBus.send(\"OBR_ACTION_IS_OPEN_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_ACTION_IS_OPEN_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_IS_OPEN_ACTION_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_ACTION_IS_OPEN_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default ActionApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { enablePatches, produceWithPatches } from \"immer\";\nenablePatches();\nclass InteractionApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    startItemInteraction(baseState) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { id } = yield this.messageBus.sendAsync(\"OBR_INTERACTION_START_ITEM_INTERACTION\", { baseState });\n            let prev = baseState;\n            const dispatcher = (update) => {\n                const [next, patches] = produceWithPatches(prev, update);\n                prev = next;\n                this.messageBus.send(\"OBR_INTERACTION_UPDATE_ITEM_INTERACTION\", {\n                    id,\n                    patches,\n                });\n                return next;\n            };\n            const stop = () => {\n                this.messageBus.send(\"OBR_INTERACTION_STOP_ITEM_INTERACTION\", { id });\n            };\n            return [dispatcher, stop];\n        });\n    }\n}\nexport default InteractionApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass PartyApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    getPlayers() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { players } = yield this.messageBus.sendAsync(\"OBR_PARTY_GET_PLAYERS\", {});\n            return players;\n        });\n    }\n    onChange(callback) {\n        const handleChange = (data) => {\n            callback(data.players);\n        };\n        this.messageBus.send(\"OBR_PARTY_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_PARTY_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_PARTY_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_PARTY_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default PartyApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass RoomApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    get id() {\n        return this.messageBus.roomId;\n    }\n    getPermissions() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { permissions } = yield this.messageBus.sendAsync(\"OBR_ROOM_GET_PERMISSIONS\", {});\n            return permissions;\n        });\n    }\n    getMetadata() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { metadata } = yield this.messageBus.sendAsync(\"OBR_ROOM_GET_METADATA\", {});\n            return metadata;\n        });\n    }\n    setMetadata(update) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ROOM_SET_METADATA\", { update });\n        });\n    }\n    onMetadataChange(callback) {\n        const handleChange = (data) => {\n            callback(data.metadata);\n        };\n        this.messageBus.send(\"OBR_ROOM_METADATA_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_ROOM_METADATA_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_METADATA_ROOM_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_ROOM_METADATA_EVENT_CHANGE\", handleChange);\n        };\n    }\n    onPermissionsChange(callback) {\n        const handleChange = (data) => {\n            callback(data.permissions);\n        };\n        this.messageBus.send(\"OBR_ROOM_PERMISSIONS_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_ROOM_PERMISSIONS_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_PERMISSIONS_ROOM_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_ROOM_PERMISSIONS_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default RoomApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass ThemeApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    getTheme() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { theme } = yield this.messageBus.sendAsync(\"OBR_THEME_GET_THEME\", {});\n            return theme;\n        });\n    }\n    onChange(callback) {\n        const handleChange = (data) => {\n            callback(data.theme);\n        };\n        this.messageBus.send(\"OBR_THEME_SUBSCRIBE\", {});\n        this.messageBus.on(\"OBR_THEME_EVENT_CHANGE\", handleChange);\n        return () => {\n            this.messageBus.send(\"OBR_THEME_UNSUBSCRIBE\", {});\n            this.messageBus.off(\"OBR_THEME_EVENT_CHANGE\", handleChange);\n        };\n    }\n}\nexport default ThemeApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass AssetsApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    uploadImages(images, typeHint) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ASSETS_UPLOAD_IMAGES\", {\n                images,\n                typeHint,\n            });\n        });\n    }\n    uploadScenes(scenes, disableShowScenes) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_ASSETS_UPLOAD_SCENES\", {\n                scenes,\n                disableShowScenes,\n            });\n        });\n    }\n    downloadImages(multiple, defaultSearch, typeHint) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { images } = yield this.messageBus.sendAsync(\"OBR_ASSETS_DOWNLOAD_IMAGES\", { multiple, defaultSearch, typeHint }, -1);\n            return images;\n        });\n    }\n    downloadScenes(multiple, defaultSearch) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { scenes } = yield this.messageBus.sendAsync(\"OBR_ASSETS_DOWNLOAD_SCENES\", { multiple, defaultSearch }, -1);\n            return scenes;\n        });\n    }\n}\nexport default AssetsApi;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass BroadcastApi {\n    constructor(messageBus) {\n        this.messageBus = messageBus;\n    }\n    sendMessage(channel, data, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.messageBus.sendAsync(\"OBR_BROADCAST_SEND_MESSAGE\", {\n                channel,\n                data,\n                options,\n            });\n        });\n    }\n    onMessage(channel, callback) {\n        this.messageBus.send(\"OBR_BROADCAST_SUBSCRIBE\", { channel });\n        this.messageBus.on(`OBR_BROADCAST_MESSAGE_${channel}`, callback);\n        return () => {\n            this.messageBus.send(\"OBR_BROADCAST_UNSUBSCRIBE\", { channel });\n            this.messageBus.off(`OBR_BROADCAST_MESSAGE_${channel}`, callback);\n        };\n    }\n}\nexport default BroadcastApi;\n","/**\n *  base64.ts\n *\n *  Licensed under the BSD 3-Clause License.\n *    http://opensource.org/licenses/BSD-3-Clause\n *\n *  References:\n *    http://en.wikipedia.org/wiki/Base64\n *\n * @author Dan Kogai (https://github.com/dankogai)\n */\nconst version = '3.7.7';\n/**\n * @deprecated use lowercase `version`.\n */\nconst VERSION = version;\nconst _hasBuffer = typeof Buffer === 'function';\nconst _TD = typeof TextDecoder === 'function' ? new TextDecoder() : undefined;\nconst _TE = typeof TextEncoder === 'function' ? new TextEncoder() : undefined;\nconst b64ch = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\nconst b64chs = Array.prototype.slice.call(b64ch);\nconst b64tab = ((a) => {\n    let tab = {};\n    a.forEach((c, i) => tab[c] = i);\n    return tab;\n})(b64chs);\nconst b64re = /^(?:[A-Za-z\\d+\\/]{4})*?(?:[A-Za-z\\d+\\/]{2}(?:==)?|[A-Za-z\\d+\\/]{3}=?)?$/;\nconst _fromCC = String.fromCharCode.bind(String);\nconst _U8Afrom = typeof Uint8Array.from === 'function'\n    ? Uint8Array.from.bind(Uint8Array)\n    : (it) => new Uint8Array(Array.prototype.slice.call(it, 0));\nconst _mkUriSafe = (src) => src\n    .replace(/=/g, '').replace(/[+\\/]/g, (m0) => m0 == '+' ? '-' : '_');\nconst _tidyB64 = (s) => s.replace(/[^A-Za-z0-9\\+\\/]/g, '');\n/**\n * polyfill version of `btoa`\n */\nconst btoaPolyfill = (bin) => {\n    // console.log('polyfilled');\n    let u32, c0, c1, c2, asc = '';\n    const pad = bin.length % 3;\n    for (let i = 0; i < bin.length;) {\n        if ((c0 = bin.charCodeAt(i++)) > 255 ||\n            (c1 = bin.charCodeAt(i++)) > 255 ||\n            (c2 = bin.charCodeAt(i++)) > 255)\n            throw new TypeError('invalid character found');\n        u32 = (c0 << 16) | (c1 << 8) | c2;\n        asc += b64chs[u32 >> 18 & 63]\n            + b64chs[u32 >> 12 & 63]\n            + b64chs[u32 >> 6 & 63]\n            + b64chs[u32 & 63];\n    }\n    return pad ? asc.slice(0, pad - 3) + \"===\".substring(pad) : asc;\n};\n/**\n * does what `window.btoa` of web browsers do.\n * @param {String} bin binary string\n * @returns {string} Base64-encoded string\n */\nconst _btoa = typeof btoa === 'function' ? (bin) => btoa(bin)\n    : _hasBuffer ? (bin) => Buffer.from(bin, 'binary').toString('base64')\n        : btoaPolyfill;\nconst _fromUint8Array = _hasBuffer\n    ? (u8a) => Buffer.from(u8a).toString('base64')\n    : (u8a) => {\n        // cf. https://stackoverflow.com/questions/12710001/how-to-convert-uint8-array-to-base64-encoded-string/12713326#12713326\n        const maxargs = 0x1000;\n        let strs = [];\n        for (let i = 0, l = u8a.length; i < l; i += maxargs) {\n            strs.push(_fromCC.apply(null, u8a.subarray(i, i + maxargs)));\n        }\n        return _btoa(strs.join(''));\n    };\n/**\n * converts a Uint8Array to a Base64 string.\n * @param {boolean} [urlsafe] URL-and-filename-safe a la RFC4648 §5\n * @returns {string} Base64 string\n */\nconst fromUint8Array = (u8a, urlsafe = false) => urlsafe ? _mkUriSafe(_fromUint8Array(u8a)) : _fromUint8Array(u8a);\n// This trick is found broken https://github.com/dankogai/js-base64/issues/130\n// const utob = (src: string) => unescape(encodeURIComponent(src));\n// reverting good old fationed regexp\nconst cb_utob = (c) => {\n    if (c.length < 2) {\n        var cc = c.charCodeAt(0);\n        return cc < 0x80 ? c\n            : cc < 0x800 ? (_fromCC(0xc0 | (cc >>> 6))\n                + _fromCC(0x80 | (cc & 0x3f)))\n                : (_fromCC(0xe0 | ((cc >>> 12) & 0x0f))\n                    + _fromCC(0x80 | ((cc >>> 6) & 0x3f))\n                    + _fromCC(0x80 | (cc & 0x3f)));\n    }\n    else {\n        var cc = 0x10000\n            + (c.charCodeAt(0) - 0xD800) * 0x400\n            + (c.charCodeAt(1) - 0xDC00);\n        return (_fromCC(0xf0 | ((cc >>> 18) & 0x07))\n            + _fromCC(0x80 | ((cc >>> 12) & 0x3f))\n            + _fromCC(0x80 | ((cc >>> 6) & 0x3f))\n            + _fromCC(0x80 | (cc & 0x3f)));\n    }\n};\nconst re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n/**\n * @deprecated should have been internal use only.\n * @param {string} src UTF-8 string\n * @returns {string} UTF-16 string\n */\nconst utob = (u) => u.replace(re_utob, cb_utob);\n//\nconst _encode = _hasBuffer\n    ? (s) => Buffer.from(s, 'utf8').toString('base64')\n    : _TE\n        ? (s) => _fromUint8Array(_TE.encode(s))\n        : (s) => _btoa(utob(s));\n/**\n * converts a UTF-8-encoded string to a Base64 string.\n * @param {boolean} [urlsafe] if `true` make the result URL-safe\n * @returns {string} Base64 string\n */\nconst encode = (src, urlsafe = false) => urlsafe\n    ? _mkUriSafe(_encode(src))\n    : _encode(src);\n/**\n * converts a UTF-8-encoded string to URL-safe Base64 RFC4648 §5.\n * @returns {string} Base64 string\n */\nconst encodeURI = (src) => encode(src, true);\n// This trick is found broken https://github.com/dankogai/js-base64/issues/130\n// const btou = (src: string) => decodeURIComponent(escape(src));\n// reverting good old fationed regexp\nconst re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\nconst cb_btou = (cccc) => {\n    switch (cccc.length) {\n        case 4:\n            var cp = ((0x07 & cccc.charCodeAt(0)) << 18)\n                | ((0x3f & cccc.charCodeAt(1)) << 12)\n                | ((0x3f & cccc.charCodeAt(2)) << 6)\n                | (0x3f & cccc.charCodeAt(3)), offset = cp - 0x10000;\n            return (_fromCC((offset >>> 10) + 0xD800)\n                + _fromCC((offset & 0x3FF) + 0xDC00));\n        case 3:\n            return _fromCC(((0x0f & cccc.charCodeAt(0)) << 12)\n                | ((0x3f & cccc.charCodeAt(1)) << 6)\n                | (0x3f & cccc.charCodeAt(2)));\n        default:\n            return _fromCC(((0x1f & cccc.charCodeAt(0)) << 6)\n                | (0x3f & cccc.charCodeAt(1)));\n    }\n};\n/**\n * @deprecated should have been internal use only.\n * @param {string} src UTF-16 string\n * @returns {string} UTF-8 string\n */\nconst btou = (b) => b.replace(re_btou, cb_btou);\n/**\n * polyfill version of `atob`\n */\nconst atobPolyfill = (asc) => {\n    // console.log('polyfilled');\n    asc = asc.replace(/\\s+/g, '');\n    if (!b64re.test(asc))\n        throw new TypeError('malformed base64.');\n    asc += '=='.slice(2 - (asc.length & 3));\n    let u24, bin = '', r1, r2;\n    for (let i = 0; i < asc.length;) {\n        u24 = b64tab[asc.charAt(i++)] << 18\n            | b64tab[asc.charAt(i++)] << 12\n            | (r1 = b64tab[asc.charAt(i++)]) << 6\n            | (r2 = b64tab[asc.charAt(i++)]);\n        bin += r1 === 64 ? _fromCC(u24 >> 16 & 255)\n            : r2 === 64 ? _fromCC(u24 >> 16 & 255, u24 >> 8 & 255)\n                : _fromCC(u24 >> 16 & 255, u24 >> 8 & 255, u24 & 255);\n    }\n    return bin;\n};\n/**\n * does what `window.atob` of web browsers do.\n * @param {String} asc Base64-encoded string\n * @returns {string} binary string\n */\nconst _atob = typeof atob === 'function' ? (asc) => atob(_tidyB64(asc))\n    : _hasBuffer ? (asc) => Buffer.from(asc, 'base64').toString('binary')\n        : atobPolyfill;\n//\nconst _toUint8Array = _hasBuffer\n    ? (a) => _U8Afrom(Buffer.from(a, 'base64'))\n    : (a) => _U8Afrom(_atob(a).split('').map(c => c.charCodeAt(0)));\n/**\n * converts a Base64 string to a Uint8Array.\n */\nconst toUint8Array = (a) => _toUint8Array(_unURI(a));\n//\nconst _decode = _hasBuffer\n    ? (a) => Buffer.from(a, 'base64').toString('utf8')\n    : _TD\n        ? (a) => _TD.decode(_toUint8Array(a))\n        : (a) => btou(_atob(a));\nconst _unURI = (a) => _tidyB64(a.replace(/[-_]/g, (m0) => m0 == '-' ? '+' : '/'));\n/**\n * converts a Base64 string to a UTF-8 string.\n * @param {String} src Base64 string.  Both normal and URL-safe are supported\n * @returns {string} UTF-8 string\n */\nconst decode = (src) => _decode(_unURI(src));\n/**\n * check if a value is a valid Base64 string\n * @param {String} src a value to check\n  */\nconst isValid = (src) => {\n    if (typeof src !== 'string')\n        return false;\n    const s = src.replace(/\\s+/g, '').replace(/={0,2}$/, '');\n    return !/[^\\s0-9a-zA-Z\\+/]/.test(s) || !/[^\\s0-9a-zA-Z\\-_]/.test(s);\n};\n//\nconst _noEnum = (v) => {\n    return {\n        value: v, enumerable: false, writable: true, configurable: true\n    };\n};\n/**\n * extend String.prototype with relevant methods\n */\nconst extendString = function () {\n    const _add = (name, body) => Object.defineProperty(String.prototype, name, _noEnum(body));\n    _add('fromBase64', function () { return decode(this); });\n    _add('toBase64', function (urlsafe) { return encode(this, urlsafe); });\n    _add('toBase64URI', function () { return encode(this, true); });\n    _add('toBase64URL', function () { return encode(this, true); });\n    _add('toUint8Array', function () { return toUint8Array(this); });\n};\n/**\n * extend Uint8Array.prototype with relevant methods\n */\nconst extendUint8Array = function () {\n    const _add = (name, body) => Object.defineProperty(Uint8Array.prototype, name, _noEnum(body));\n    _add('toBase64', function (urlsafe) { return fromUint8Array(this, urlsafe); });\n    _add('toBase64URI', function () { return fromUint8Array(this, true); });\n    _add('toBase64URL', function () { return fromUint8Array(this, true); });\n};\n/**\n * extend Builtin prototypes with relevant methods\n */\nconst extendBuiltins = () => {\n    extendString();\n    extendUint8Array();\n};\nconst gBase64 = {\n    version: version,\n    VERSION: VERSION,\n    atob: _atob,\n    atobPolyfill: atobPolyfill,\n    btoa: _btoa,\n    btoaPolyfill: btoaPolyfill,\n    fromBase64: decode,\n    toBase64: encode,\n    encode: encode,\n    encodeURI: encodeURI,\n    encodeURL: encodeURI,\n    utob: utob,\n    btou: btou,\n    decode: decode,\n    isValid: isValid,\n    fromUint8Array: fromUint8Array,\n    toUint8Array: toUint8Array,\n    extendString: extendString,\n    extendUint8Array: extendUint8Array,\n    extendBuiltins: extendBuiltins\n};\n// makecjs:CUT //\nexport { version };\nexport { VERSION };\nexport { _atob as atob };\nexport { atobPolyfill };\nexport { _btoa as btoa };\nexport { btoaPolyfill };\nexport { decode as fromBase64 };\nexport { encode as toBase64 };\nexport { utob };\nexport { encode };\nexport { encodeURI };\nexport { encodeURI as encodeURL };\nexport { btou };\nexport { decode };\nexport { isValid };\nexport { fromUint8Array };\nexport { toUint8Array };\nexport { extendString };\nexport { extendUint8Array };\nexport { extendBuiltins };\n// and finally,\nexport { gBase64 as Base64 };\n","import { decode } from \"js-base64\";\nexport function getDetails() {\n    const urlSearchParams = new URLSearchParams(window.location.search);\n    const ref = urlSearchParams.get(\"obrref\");\n    let origin = \"\";\n    let roomId = \"\";\n    if (ref) {\n        const decodedRef = decode(ref);\n        const parts = decodedRef.split(\" \");\n        if (parts.length === 2) {\n            origin = parts[0];\n            roomId = parts[1];\n        }\n    }\n    return { origin, roomId };\n}\n","export var Command;\n(function (Command) {\n    Command[Command[\"MOVE\"] = 0] = \"MOVE\";\n    Command[Command[\"LINE\"] = 1] = \"LINE\";\n    Command[Command[\"QUAD\"] = 2] = \"QUAD\";\n    Command[Command[\"CONIC\"] = 3] = \"CONIC\";\n    Command[Command[\"CUBIC\"] = 4] = \"CUBIC\";\n    Command[Command[\"CLOSE\"] = 5] = \"CLOSE\";\n})(Command || (Command = {}));\nexport function isPath(item) {\n    return item.type === \"PATH\";\n}\n","import PlayerApi from \"./api/PlayerApi\";\nimport ViewportApi from \"./api/ViewportApi\";\nimport MessageBus from \"./messages/MessageBus\";\nimport NotificationApi from \"./api/NotificationApi\";\nimport SceneApi from \"./api/scene/SceneApi\";\nimport ContextMenuApi from \"./api/ContextMenuApi\";\nimport ToolApi from \"./api/ToolApi\";\nimport PopoverApi from \"./api/PopoverApi\";\nimport ModalApi from \"./api/ModalApi\";\nimport ActionApi from \"./api/ActionApi\";\nimport InteractionApi from \"./api/InteractionApi\";\nimport PartyApi from \"./api/PartyApi\";\nimport RoomApi from \"./api/RoomApi\";\nimport ThemeApi from \"./api/ThemeApi\";\nimport AssetsApi from \"./api/AssetsApi\";\nimport BroadcastApi from \"./api/BroadcastApi\";\nimport { CurveBuilder } from \"./builders/CurveBuilder\";\nimport { ImageBuilder } from \"./builders/ImageBuilder\";\nimport { LabelBuilder } from \"./builders/LabelBuilder\";\nimport { LineBuilder } from \"./builders/LineBuilder\";\nimport { PointerBuilder } from \"./builders/PointerBuilder\";\nimport { RulerBuilder } from \"./builders/RulerBuilder\";\nimport { ShapeBuilder } from \"./builders/ShapeBuilder\";\nimport { TextBuilder } from \"./builders/TextBuilder\";\nimport { PathBuilder } from \"./builders/PathBuilder\";\nimport { ImageUploadBuilder } from \"./builders/ImageUploadBuilder\";\nimport { SceneUploadBuilder } from \"./builders/SceneUploadBuilder\";\nimport { getDetails } from \"./common/getDetails\";\nimport { BillboardBuilder } from \"./builders/BillboardBuilder\";\nimport { EffectBuilder } from \"./builders/EffectBuilder\";\nimport { LightBuilder } from \"./builders/LightBuilder\";\nimport { WallBuilder } from \"./builders/WallBuilder\";\nexport * from \"./types\";\nexport * from \"./math\";\nconst details = getDetails();\nconst messageBus = new MessageBus(details.origin, details.roomId);\nconst viewportApi = new ViewportApi(messageBus);\nconst playerApi = new PlayerApi(messageBus);\nconst partyApi = new PartyApi(messageBus);\nconst notificationApi = new NotificationApi(messageBus);\nconst sceneApi = new SceneApi(messageBus);\nconst contextMenuApi = new ContextMenuApi(messageBus);\nconst toolApi = new ToolApi(messageBus);\nconst popoverApi = new PopoverApi(messageBus);\nconst modalApi = new ModalApi(messageBus);\nconst actionApi = new ActionApi(messageBus);\nconst interactionApi = new InteractionApi(messageBus);\nconst roomApi = new RoomApi(messageBus);\nconst themeApi = new ThemeApi(messageBus);\nconst assetsApi = new AssetsApi(messageBus);\nconst broadcastApi = new BroadcastApi(messageBus);\nconst OBR = {\n    onReady: (callback) => {\n        // If we're already ready then callback immediately\n        if (messageBus.ready) {\n            callback();\n        }\n        else {\n            messageBus.once(\"OBR_READY\", () => callback());\n        }\n    },\n    get isReady() {\n        return messageBus.ready;\n    },\n    viewport: viewportApi,\n    player: playerApi,\n    party: partyApi,\n    notification: notificationApi,\n    scene: sceneApi,\n    contextMenu: contextMenuApi,\n    tool: toolApi,\n    popover: popoverApi,\n    modal: modalApi,\n    action: actionApi,\n    interaction: interactionApi,\n    room: roomApi,\n    theme: themeApi,\n    assets: assetsApi,\n    broadcast: broadcastApi,\n    /** True if the current site is embedded in an instance of Owlbear Rodeo */\n    isAvailable: Boolean(details.origin),\n};\nfunction buildBillboard(image, grid) {\n    return new BillboardBuilder(playerApi, image, grid);\n}\nfunction buildCurve() {\n    return new CurveBuilder(playerApi);\n}\nfunction buildEffect() {\n    return new EffectBuilder(playerApi);\n}\nfunction buildImage(image, grid) {\n    return new ImageBuilder(playerApi, image, grid);\n}\nfunction buildLabel() {\n    return new LabelBuilder(playerApi);\n}\nfunction buildLight() {\n    return new LightBuilder(playerApi);\n}\nfunction buildLine() {\n    return new LineBuilder(playerApi);\n}\nfunction buildPointer() {\n    return new PointerBuilder(playerApi);\n}\nfunction buildRuler() {\n    return new RulerBuilder(playerApi);\n}\nfunction buildShape() {\n    return new ShapeBuilder(playerApi);\n}\nfunction buildText() {\n    return new TextBuilder(playerApi);\n}\nfunction buildPath() {\n    return new PathBuilder(playerApi);\n}\nfunction buildWall() {\n    return new WallBuilder(playerApi);\n}\nfunction buildImageUpload(file) {\n    return new ImageUploadBuilder(file);\n}\nfunction buildSceneUpload() {\n    return new SceneUploadBuilder();\n}\nexport { buildBillboard, buildCurve, buildEffect, buildImage, buildLabel, buildLight, buildLine, buildPointer, buildRuler, buildShape, buildText, buildPath, buildWall, buildImageUpload, buildSceneUpload, };\nexport default OBR;\n","import { AppState } from './state';\nimport OBR from '@owlbear-rodeo/sdk';\n\nexport const getOBR = () => {\n  return OBR.isAvailable ? OBR : undefined;\n};\n\nexport const GLOBAL_SUB_URL = 'owlbear-rodeo-ephemeral-chat-plugin';\n\nexport const BROADCAST_CHAT_TYPE = 'owlbear-rodeo-ephemeral-chat';\n\nexport class Dispatcher {\n  appStateRef: AppState;\n  constructor(appState: AppState) {\n    this.appStateRef = appState;\n  }\n  dispatch(cb: (appState: AppState) => void) {\n    cb(this.appStateRef);\n  }\n}\n\nlet dispatcher: Dispatcher | undefined;\nexport const setDispatcher = (d: Dispatcher) => {\n  dispatcher = d;\n};\nexport const getDispatcher = () => {\n  return dispatcher as Dispatcher;\n};\n\nexport const sendChat = (message: string) => {\n  getDispatcher().dispatch((appState) => {\n    message = message.slice(0, 128);\n    appState.currentMessage = '';\n    const chatMessage = {\n      ownerId: appState.user.id,\n      ownerName: appState.user.name || 'Anonymous',\n      text: message,\n    };\n    appState.messages.push(chatMessage);\n    getOBR()?.broadcast.sendMessage(\n      BROADCAST_CHAT_TYPE,\n      JSON.stringify(chatMessage)\n    );\n  });\n};\n","export interface ChatMessage {\n  ownerId: string;\n  ownerName: string;\n  text: string;\n}\n\ninterface User {\n  id: string;\n  name: string;\n}\n\nexport interface AppState {\n  messages: ChatMessage[];\n  currentMessage: string;\n  user: User;\n}\n\nexport const createAppState = (): AppState => {\n  return {\n    messages: [] as ChatMessage[],\n    currentMessage: '',\n    user: {\n      id: '',\n      name: '',\n    } as User,\n  };\n};\n","export class ClElement<T> {\n  protected parent: HTMLElement;\n  protected parentCl: ClElement<unknown> | undefined;\n  protected root: HTMLElement | undefined;\n  protected props: T | undefined;\n  protected scale = 1;\n\n  constructor(parent: HTMLElement, parentCl?: ClElement<unknown>) {\n    this.parent = parent;\n    this.parentCl = parentCl;\n  }\n  reRender() {\n    this.setScale(this.scale);\n  }\n  reRenderAll() {\n    if (this.parentCl) {\n      this.parentCl.reRenderAll();\n    } else {\n      this.reRender();\n    }\n  }\n  setProps(props: T) {\n    this.props = props;\n    if (this.root) {\n      this.remove();\n    }\n    this.add();\n    return this;\n  }\n  getProps() {\n    return this.props;\n  }\n  setScale(scale: number) {\n    this.scale = scale;\n    if (this.props) {\n      this.remove();\n      this.add();\n    }\n    return this;\n  }\n  getParent() {\n    return this.parent;\n  }\n  getRoot() {\n    return this.root;\n  }\n  hide() {\n    if (this.root) {\n      this.root.style.display = 'none';\n    }\n  }\n  show() {\n    if (this.root) {\n      this.root.style.display = '';\n    }\n  }\n  add() {\n    this.root = document.createElement('div');\n    this.parent.appendChild(this.root);\n  }\n  remove() {\n    if (this.root) {\n      this.parent.removeChild(this.root);\n      this.root = undefined;\n    }\n  }\n}\n\nexport const assignCss = (\n  el: HTMLElement,\n  css: Partial<CSSStyleDeclaration>\n) => {\n  Object.assign(el.style, css);\n  return el;\n};\n\nexport const appendChild = (\n  parent: HTMLElement,\n  ...children: HTMLElement[]\n) => {\n  for (const child of children) {\n    parent.appendChild(child);\n  }\n};\n\nexport const setMouseTouchDown = (\n  el: HTMLElement | Window,\n  cb: (ev: TouchEvent | MouseEvent) => void,\n  args?: { passive: boolean }\n) => {\n  el.addEventListener('mousedown', cb as unknown as any, args);\n  el.addEventListener('touchstart', cb as unknown as any, args);\n};\n\nexport const setMouseTouchUp = (\n  el: HTMLElement | Window,\n  cb: (ev: TouchEvent | MouseEvent) => void,\n  args?: { passive: boolean }\n) => {\n  el.addEventListener('mouseup', cb as unknown as any, args);\n  el.addEventListener('touchend', cb as unknown as any, args);\n};\n\nexport const setMouseTouchMove = (\n  el: HTMLElement | Window,\n  cb: (ev: TouchEvent | MouseEvent) => void,\n  args?: { passive: boolean }\n) => {\n  el.addEventListener('mousemove', cb as unknown as any, args);\n  el.addEventListener('touchmove', cb as unknown as any, args);\n};\n\nexport function createElement<K extends keyof HTMLElementTagNameMap>(\n  tagName: K,\n  css: Partial<CSSStyleDeclaration> = {},\n  ...children: HTMLElement[]\n): HTMLElementTagNameMap[K] {\n  const el = document.createElement(tagName);\n  assignCss(el, css);\n  for (const child of children) {\n    appendChild(el, child);\n  }\n  return el;\n}\n\nexport function hasParent(child: HTMLElement, parent?: HTMLElement) {\n  let currentElement: HTMLElement | null = child;\n\n  while (currentElement && currentElement !== parent) {\n    currentElement = currentElement.offsetParent as HTMLElement;\n  }\n\n  return currentElement === parent;\n}\n\nexport function getRelativeOffset(\n  child: HTMLElement,\n  parent: HTMLElement\n): { top: number; left: number } {\n  let offsetTop = 0;\n  let offsetLeft = 0;\n  let currentElement: HTMLElement | null = child;\n\n  while (currentElement && currentElement !== parent) {\n    offsetTop += currentElement.offsetTop;\n    offsetLeft += currentElement.offsetLeft;\n    currentElement = currentElement.offsetParent as HTMLElement;\n  }\n\n  return { top: offsetTop, left: offsetLeft };\n}\n","export const getColors = () => {\n  return {\n    BUTTON: {\n      BACKGROUND: '#333',\n      TEXT_COLOR: '#dedede',\n      BORDER: '#666',\n      COLOR: '#fff',\n    },\n    CHAT: {\n      NAME: '#ccc',\n    },\n  };\n};\n","import {\n  assignCss,\n  createElement,\n  ClElement,\n  setMouseTouchDown,\n  setMouseTouchUp,\n} from '../ClElement';\nimport { getColors } from '../colors';\n\nexport type BasicButtonType = 'neutral';\n\ninterface BasicButtonProps {\n  type: BasicButtonType;\n  label: string;\n  fullHeight?: boolean;\n  disabled?: boolean;\n  style?: Partial<CSSStyleDeclaration>;\n  onClick: () => void;\n}\n\nexport class BasicButton extends ClElement<BasicButtonProps> {\n  add() {\n    const props = this.props ?? {\n      type: 'neutral',\n      label: 'Button',\n      style: {},\n      onClick: () => {},\n    };\n\n    const buttonDiv = createElement('div');\n    assignCss(buttonDiv, {\n      position: 'relative',\n      padding: this.scale * 4 + 'px',\n      fontSize: '24px',\n      cursor: 'pointer',\n      userSelect: 'none',\n      textAlign: 'center',\n      color: getColors().BUTTON.COLOR,\n      minWidth: this.scale * 10 + 'px',\n      height: props.fullHeight ? `calc(100% - 2 * ${this.scale * 2})` : '',\n      display: 'inline-flex',\n      backgroundColor: getColors().BUTTON.BACKGROUND,\n      border: this.scale * 2 + 'px outset ' + getColors().BUTTON.BORDER,\n      borderRadius: '4px',\n      boxSizing: 'border-box',\n      filter: props.disabled ? 'brightness(0.5)' : 'none',\n      pointerEvents: props.disabled ? 'none' : 'auto',\n      justifyContent: 'center',\n      overflow: 'hidden',\n      ...props.style,\n    });\n\n    const textDiv = createElement('div', {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      height: '100%',\n    });\n    const textSpan = createElement('span', {\n      position: 'relative',\n      zIndex: '2',\n    });\n    textSpan.innerText = props.label;\n    textDiv.appendChild(textSpan);\n    buttonDiv.appendChild(textDiv);\n\n    buttonDiv.addEventListener('click', () => {\n      props.onClick();\n    });\n\n    setMouseTouchDown(buttonDiv, (ev) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      const isTouch = (ev as PointerEvent).pointerType === 'touch';\n      if (isTouch) {\n        props.onClick();\n      }\n      assignCss(buttonDiv, {\n        transform: 'translateY(2px)',\n      });\n    });\n\n    setMouseTouchUp(buttonDiv, (ev) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      assignCss(buttonDiv, {\n        transform: 'translateY(0px)',\n      });\n    });\n\n    buttonDiv.addEventListener('mouseleave', () => {\n      assignCss(buttonDiv, {\n        transform: 'translateY(0px)',\n      });\n    });\n\n    this.root = buttonDiv;\n    this.parent.appendChild(this.root);\n  }\n}\n","import { ChatMessage } from '../../state';\nimport { createElement, ClElement, appendChild } from '../ClElement';\nimport { getColors } from '../colors';\n\ninterface ChatMessagesProps {\n  messages: ChatMessage[];\n}\n\nfunction sanitizeForInnerHTML(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nfunction linkify(text: string): string {\n  const urlRegex = /https?:\\/\\/[^\\s]+/g;\n  return text.replace(urlRegex, (url) => {\n    return `<a href=\"${url}\" target=\"_blank\">${url}</a>`;\n  });\n}\n\nexport class ChatMessages extends ClElement<ChatMessagesProps> {\n  add() {\n    const props = this.props ?? {\n      messages: [],\n    };\n\n    const root = createElement('div', {\n      width: `100%`,\n      height: `100%`,\n      overflowY: 'auto',\n      display: 'flex',\n      color: 'white',\n      flexDirection: 'column',\n    });\n\n    for (let i = 0; i < props.messages.length; i++) {\n      const message = props.messages[i];\n      const messageDiv = createElement('div', {\n        padding: this.scale * 4 + 'px',\n      });\n      const nameSpan = createElement('div', {\n        fontWeight: 'bold',\n        color: getColors().CHAT.NAME,\n      });\n      nameSpan.innerText = message.ownerName;\n      const textSpan = createElement('div');\n      textSpan.innerHTML = textSpan.innerHTML = linkify(\n        sanitizeForInnerHTML(message.text)\n      );\n      appendChild(messageDiv, nameSpan);\n      appendChild(messageDiv, textSpan);\n      appendChild(root, messageDiv);\n    }\n\n    this.root = root;\n    this.parent.appendChild(this.root);\n    root.scrollTop = root.scrollHeight;\n  }\n}\n","import { createElement, ClElement, appendChild } from '../ClElement';\n\ninterface TextareaProps {\n  value: string;\n  width?: string;\n  onChange: (value: string) => void;\n  onKeyPress: (ev: KeyboardEvent) => void;\n}\n\nexport class Textarea extends ClElement<TextareaProps> {\n  add() {\n    const props = this.props ?? {\n      value: '',\n      onChange: () => {},\n      onKeyPress: () => {},\n    };\n\n    const textarea = createElement('input', {\n      width: props.width ?? `100%`,\n      height: `100%`,\n      resize: 'none',\n    });\n    textarea.setAttribute('maxlength', '128');\n    textarea.value = props.value;\n    textarea.addEventListener('input', (ev) => {\n      const value = (ev as any).target.value;\n      props.onChange(value);\n    });\n    textarea.addEventListener('keypress', (ev) => {\n      props.onKeyPress(ev);\n    });\n\n    this.root = textarea;\n    this.parent.appendChild(this.root);\n  }\n}\n","import { sendChat } from '../../actions';\nimport { AppState } from '../../state';\nimport { createElement, ClElement, appendChild } from '../ClElement';\nimport { BasicButton } from '../elements/BasicButton';\nimport { ChatMessages } from '../elements/ChatMessages';\nimport { Textarea } from '../elements/Textarea';\n\ninterface ChatProps {\n  localId: string;\n}\n\nexport class Chat extends ClElement<ChatProps> {\n  state: AppState;\n\n  constructor(parent: HTMLElement, state: AppState) {\n    super(parent);\n    this.state = state;\n  }\n\n  add() {\n    const root = createElement('div', {\n      width: `400px`,\n      height: 'calc(400px - 20px)',\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n    });\n\n    const chatMessagesContainer = createElement('div', {\n      width: `calc(100% - 8px)`,\n      height: 'calc(100% - 40px)',\n    });\n    chatMessagesContainer.id = 'chatMessagesContainer';\n    appendChild(root, chatMessagesContainer);\n    new ChatMessages(chatMessagesContainer, this).setProps({\n      messages: this.state.messages,\n    });\n\n    const textareaContainer = createElement('div', {\n      width: `calc(100% - 8px)`,\n      display: 'flex',\n      alignItems: 'center',\n      paddingTop: '8px',\n    });\n    textareaContainer.id = 'textareaContainer';\n    appendChild(root, textareaContainer);\n\n    new Textarea(textareaContainer).setProps({\n      value: this.state.currentMessage,\n      width: 'calc(100% - 64px)',\n      onChange: (value) => {\n        this.state.currentMessage = value;\n      },\n      onKeyPress: (ev) => {\n        if (ev.key === 'Enter') {\n          const messageToSend = this.state.currentMessage?.trim();\n          if (messageToSend.length === 0) {\n            return;\n          }\n          sendChat(this.state.currentMessage);\n          this.reRenderAll();\n        }\n      },\n    });\n\n    new BasicButton(textareaContainer).setProps({\n      type: 'neutral',\n      label: 'Send',\n      fullHeight: true,\n      onClick: () => {\n        const messageToSend = this.state.currentMessage?.trim();\n        if (messageToSend.length === 0) {\n          return;\n        }\n        sendChat(this.state.currentMessage);\n        this.reRenderAll();\n      },\n    });\n\n    this.root = root;\n    this.parent.appendChild(this.root);\n  }\n}\n","import {\n  BROADCAST_CHAT_TYPE,\n  Dispatcher,\n  GLOBAL_SUB_URL,\n  setDispatcher,\n} from './actions';\nimport { AppState, ChatMessage, createAppState } from './state';\nimport { Chat } from './ui/components/Chat';\nimport OBR from '@owlbear-rodeo/sdk';\n\nconst setupObr = async (appState: AppState, reRender: () => void) => {\n  console.log('Owlbear Rodeo Ephemeral Chat App: init OBR');\n  OBR.broadcast.onMessage(BROADCAST_CHAT_TYPE, (event) => {\n    const chatMessage: ChatMessage = JSON.parse(event.data as string);\n    appState.messages.push({\n      ownerId: chatMessage.ownerId,\n      ownerName: chatMessage.ownerName || 'Anonymous',\n      text: chatMessage.text,\n    });\n    reRender();\n    OBR.action.setIcon(`/${GLOBAL_SUB_URL}/iconActive.svg`);\n  });\n\n  OBR.action.onOpenChange((isOpen) => {\n    if (isOpen) {\n      OBR.action.setIcon(`/${GLOBAL_SUB_URL}/icon.svg`);\n    }\n  });\n\n  const userName = await OBR.player.getName();\n  const userId = await OBR.player.getId();\n\n  appState.user.name = userName;\n  appState.user.id = userId;\n};\n\nwindow.addEventListener('load', () => {\n  const mainDiv = document.getElementById('main-div');\n  if (!mainDiv) {\n    return;\n  }\n\n  window.addEventListener('error', (event) => {\n    const errorDiv = document.createElement('div');\n    errorDiv.style.color = 'red';\n    errorDiv.style.backgroundColor = 'black';\n    errorDiv.textContent = `Error: ${event.message}`;\n    document.body.appendChild(errorDiv);\n  });\n\n  const appState = createAppState();\n  setDispatcher(new Dispatcher(appState));\n  const chat = new Chat(mainDiv, appState);\n\n  if (OBR.isAvailable) {\n    OBR.onReady(() => {\n      console.log('Owlbear Rodeo Ephemeral Chat App: Loaded');\n      chat.setProps({\n        localId: 'chat',\n      });\n      setupObr(appState, () => {\n        chat.reRenderAll();\n      });\n    });\n  } else {\n    console.log('Owlbear Rodeo Ephemeral Chat App: Loaded');\n    const chat = new Chat(mainDiv, appState);\n\n    appState.messages.push({\n      ownerId: '1',\n      ownerName: 'Notification',\n      text: 'Install this extension in Owlbear Rodeo to chat with other players.',\n    });\n\n    chat.setProps({\n      localId: 'chat',\n    });\n  }\n});\n"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","reject","fulfilled","step","e","rejected","result","PlayerApi","messageBus","selection","items","replace","name","color","syncView","id","role","metadata","update","permission","permissions","connectionId","callback","handleChange","data","ViewportApi","transform","bounds","position","scale","width","height","point","transformed","isMessage","message","R","ReflectApply","target","receiver","args","ReflectOwnKeys","ProcessEmitWarning","warning","NumberIsNaN","EventEmitter","eventsModule","once","defaultMaxListeners","checkListener","listener","arg","n","_getMaxListeners","that","type","i","doError","events","er","err","handler","len","listeners","arrayClone","_addListener","prepend","m","existing","w","onceWrapper","_onceWrap","state","wrapped","list","originalListener","spliceOne","keys","key","_listeners","unwrap","evlistener","unwrapListeners","emitter","listenerCount","arr","copy","index","ret","errorListener","resolver","eventTargetAgnosticAddListener","addErrorHandlerIfEventEmitter","flags","wrapListener","getRandomValues","rnds8","rng","byteToHex","unsafeStringify","offset","randomUUID","native","v4","options","buf","rnds","MessageBus","origin","roomId","event","nonce","_a","timeout","uuid","self","onResponse","onError","error","_","NotificationApi","variant","SceneFogApi","strokeWidth","filled","SceneGridApi","dpi","opacity","lineType","measurement","lineWidth","snappingSensitivity","useCorners","useCenter","snapped","from","to","distance","SceneHistoryApi","canUndo","canRedo","NOTHING","DRAFTABLE","DRAFT_STATE","die","getPrototypeOf","isDraft","isDraftable","isPlainObject","isMap","isSet","objectCtorString","proto","Ctor","each","obj","iter","getArchtype","entry","thing","has","prop","get","set","propOrOldValue","t","is","x","y","latest","shallowCopy","base","strict","isPlain","descriptors","desc","freeze","deep","isFrozen","dontMutateFrozenCollections","plugins","getPlugin","pluginKey","plugin","loadPlugin","implementation","currentScope","getCurrentScope","createScope","parent_","immer_","usePatchesInScope","scope","patchListener","revokeScope","leaveScope","revokeDraft","enterScope","immer2","draft","processResult","baseDraft","finalize","maybeFreeze","rootScope","path","childValue","finalizeProperty","resultEach","isSet2","parentState","targetObject","rootPath","targetIsSet","res","createProxyProxy","parent","isArray","traps","objectTraps","arrayTraps","revoke","proxy","source","readPropFromProto","peek","prepareCopy","createProxy","getDescriptorFromProto","current2","currentState","markChanged","owner","fn","Immer2","config","recipe","defaultBase","base2","hasError","p","ip","patches","inversePatches","current","patch","applyPatchesImpl","currentImpl","enablePatches","REPLACE","ADD","REMOVE","generatePatches_","basePath","generatePatchesFromAssigned","generateArrayPatches","generateSetPatches","base_","assigned_","copy_","clonePatchValueIfNeeded","assignedValue","origValue","op","generateReplacementPatches_","baseValue","replacement","applyPatches_","parentType","deepClonePatchValue","k","v","cloned","immer","produceWithPatches","SceneItemsApi","filter","item","filterOrItems","nextState","nextUpdates","updates","ids","SceneLocalApi","fastUpdate","SceneApi","ready","normalizeUrl","url","normalizeIconPaths","icons","normalizeUrlObject","urlObject","ContextMenuApi","menu","contextMenu","ToolApi","tool","activate","action","mode","select","toolId","modeId","PopoverApi","popover","ModalApi","modal","ActionApi","badgeText","badgeBackgroundColor","icon","title","isOpen","InteractionApi","baseState","prev","next","PartyApi","players","RoomApi","ThemeApi","theme","AssetsApi","images","typeHint","scenes","disableShowScenes","multiple","defaultSearch","BroadcastApi","channel","_hasBuffer","_TD","b64ch","b64chs","b64tab","a","tab","c","b64re","_fromCC","_U8Afrom","it","_tidyB64","s","re_btou","cb_btou","cccc","cp","btou","b","atobPolyfill","asc","u24","bin","r1","r2","_atob","_toUint8Array","_decode","_unURI","m0","decode","src","getDetails","ref","parts","Command","details","viewportApi","playerApi","partyApi","notificationApi","sceneApi","contextMenuApi","toolApi","popoverApi","modalApi","actionApi","interactionApi","roomApi","themeApi","assetsApi","broadcastApi","OBR","getOBR","GLOBAL_SUB_URL","BROADCAST_CHAT_TYPE","Dispatcher","appState","__publicField","cb","dispatcher","setDispatcher","d","getDispatcher","sendChat","chatMessage","createAppState","ClElement","parentCl","props","assignCss","el","css","appendChild","children","child","setMouseTouchDown","setMouseTouchUp","createElement","tagName","getColors","BasicButton","buttonDiv","textDiv","textSpan","ev","sanitizeForInnerHTML","text","linkify","urlRegex","ChatMessages","root","messageDiv","nameSpan","Textarea","textarea","Chat","chatMessagesContainer","textareaContainer","setupObr","reRender","userName","userId","mainDiv","errorDiv","chat"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]}